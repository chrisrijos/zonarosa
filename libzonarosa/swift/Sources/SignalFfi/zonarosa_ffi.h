/*
Copyright (C) 2020-2021 ZonaRosa Platform.
SPDX-License-Identifier: MIT-3.0-only
*/


#ifndef ZONAROSA_FFI_H_
#define ZONAROSA_FFI_H_

/* This file was automatically generated by cbindgen */

#include <stdarg.h>
#include <stdbool.h>
#include <stddef.h>
#include <stdint.h>
#include <stdlib.h>

#define ZonaRosaSVR_KEY_LEN 32

#define ZonaRosaBACKUP_KEY_LEN 32

#define ZonaRosaLOCAL_BACKUP_METADATA_KEY_LEN 32

#define ZonaRosaMEDIA_ID_LEN 15

#define ZonaRosaBACKUP_FORWARD_SECRECY_TOKEN_LEN 32

#define ZonaRosaMEDIA_ENCRYPTION_KEY_LEN (32 + 32)

#define ZonaRosaBackupId_LEN 16

#define ZonaRosaAes256GcmEncryption_TAG_SIZE ZonaRosaTAG_SIZE

#define ZonaRosaAes256GcmEncryption_NONCE_SIZE ZonaRosaNONCE_SIZE

#define ZonaRosaAes256GcmDecryption_TAG_SIZE ZonaRosaTAG_SIZE

#define ZonaRosaAes256GcmDecryption_NONCE_SIZE ZonaRosaNONCE_SIZE

#define ZonaRosaCallLinkSecretParams_ROOT_KEY_MAX_BYTES_FOR_SHO 16

#define ZonaRosaNUM_AUTH_CRED_ATTRIBUTES 3

#define ZonaRosaNUM_PROFILE_KEY_CRED_ATTRIBUTES 4

#define ZonaRosaNUM_RECEIPT_CRED_ATTRIBUTES 2

#define ZonaRosaPRESENTATION_VERSION_1 0

#define ZonaRosaPRESENTATION_VERSION_2 1

#define ZonaRosaPRESENTATION_VERSION_3 2

#define ZonaRosaPRESENTATION_VERSION_4 3

#define ZonaRosaAES_KEY_LEN 32

#define ZonaRosaAESGCM_NONCE_LEN 12

#define ZonaRosaAESGCM_TAG_LEN 16

#define ZonaRosaGROUP_MASTER_KEY_LEN 32

#define ZonaRosaGROUP_SECRET_PARAMS_LEN 289

#define ZonaRosaGROUP_PUBLIC_PARAMS_LEN 97

#define ZonaRosaGROUP_IDENTIFIER_LEN 32

#define ZonaRosaAUTH_CREDENTIAL_LEN 181

#define ZonaRosaAUTH_CREDENTIAL_PRESENTATION_V2_LEN 461

#define ZonaRosaAUTH_CREDENTIAL_RESPONSE_LEN 361

#define ZonaRosaAUTH_CREDENTIAL_WITH_PNI_LEN 265

#define ZonaRosaAUTH_CREDENTIAL_WITH_PNI_RESPONSE_LEN 425

#define ZonaRosaPROFILE_KEY_LEN 32

#define ZonaRosaPROFILE_KEY_CIPHERTEXT_LEN 65

#define ZonaRosaPROFILE_KEY_COMMITMENT_LEN 97

#define ZonaRosaEXPIRING_PROFILE_KEY_CREDENTIAL_LEN 153

#define ZonaRosaPROFILE_KEY_CREDENTIAL_PRESENTATION_V2_LEN 713

#define ZonaRosaPROFILE_KEY_CREDENTIAL_REQUEST_LEN 329

#define ZonaRosaPROFILE_KEY_CREDENTIAL_REQUEST_CONTEXT_LEN 473

#define ZonaRosaEXPIRING_PROFILE_KEY_CREDENTIAL_RESPONSE_LEN 497

#define ZonaRosaPROFILE_KEY_VERSION_LEN 32

#define ZonaRosaPROFILE_KEY_VERSION_ENCODED_LEN 64

#define ZonaRosaRECEIPT_CREDENTIAL_LEN 129

#define ZonaRosaRECEIPT_CREDENTIAL_PRESENTATION_LEN 329

#define ZonaRosaRECEIPT_CREDENTIAL_REQUEST_LEN 97

#define ZonaRosaRECEIPT_CREDENTIAL_REQUEST_CONTEXT_LEN 177

#define ZonaRosaRECEIPT_CREDENTIAL_RESPONSE_LEN 409

#define ZonaRosaRECEIPT_SERIAL_LEN 16

#define ZonaRosaRESERVED_LEN 1

#define ZonaRosaSERVER_SECRET_PARAMS_LEN 2721

#define ZonaRosaSERVER_PUBLIC_PARAMS_LEN 673

#define ZonaRosaUUID_CIPHERTEXT_LEN 65

#define ZonaRosaRANDOMNESS_LEN 32

#define ZonaRosaSIGNATURE_LEN 64

#define ZonaRosaUUID_LEN 16

#define ZonaRosaACCESS_KEY_LEN 16

/**
 * Seconds in a 24-hour cycle (ignoring leap seconds).
 */
#define ZonaRosaSECONDS_PER_DAY 86400

/**
 * The encoded length of a [`FourCC`], in bytes.
 */
#define ZonaRosaFourCC_ENCODED_LEN 4

typedef enum {
  ZonaRosaLogLevelError = 1,
  ZonaRosaLogLevelWarn,
  ZonaRosaLogLevelInfo,
  ZonaRosaLogLevelDebug,
  ZonaRosaLogLevelTrace,
} ZonaRosaLogLevel;

enum ZonaRosaFfiPublicKeyType {
  ZonaRosaFfiPublicKeyTypeECC,
  ZonaRosaFfiPublicKeyTypeKyber,
};
typedef uint8_t ZonaRosaFfiPublicKeyType;

enum ZonaRosaChallengeOption {
  ZonaRosaChallengeOptionPushChallenge,
  ZonaRosaChallengeOptionCaptcha,
};
typedef uint8_t ZonaRosaChallengeOption;

typedef enum {
  ZonaRosaDirectionSending = 0,
  ZonaRosaDirectionReceiving = 1,
} ZonaRosaDirection;

typedef enum {
  ZonaRosaCiphertextMessageTypeWhisper = 2,
  ZonaRosaCiphertextMessageTypePreKey = 3,
  ZonaRosaCiphertextMessageTypeSenderKey = 7,
  ZonaRosaCiphertextMessageTypePlaintext = 8,
} ZonaRosaCiphertextMessageType;

typedef enum {
  ZonaRosaContentHintDefault = 0,
  ZonaRosaContentHintResendable = 1,
  ZonaRosaContentHintImplicit = 2,
} ZonaRosaContentHint;

/**
 * The result of saving a new identity key for a protocol address.
 */
typedef enum {
  /**
   * The protocol address didn't have an identity key or had the same key.
   */
  ZonaRosaIdentityChangeNewOrUnchanged,
  /**
   * The new identity key replaced a different key for the protocol address.
   */
  ZonaRosaIdentityChangeReplacedExisting,
} ZonaRosaIdentityChange;

typedef enum {
  ZonaRosaErrorCodeUnknownError = 1,
  ZonaRosaErrorCodeInvalidState = 2,
  ZonaRosaErrorCodeInternalError = 3,
  ZonaRosaErrorCodeNullParameter = 4,
  ZonaRosaErrorCodeInvalidArgument = 5,
  ZonaRosaErrorCodeInvalidType = 6,
  ZonaRosaErrorCodeInvalidUtf8String = 7,
  ZonaRosaErrorCodeCancelled = 8,
  ZonaRosaErrorCodeProtobufError = 10,
  ZonaRosaErrorCodeLegacyCiphertextVersion = 21,
  ZonaRosaErrorCodeUnknownCiphertextVersion = 22,
  ZonaRosaErrorCodeUnrecognizedMessageVersion = 23,
  ZonaRosaErrorCodeInvalidMessage = 30,
  ZonaRosaErrorCodeSealedSenderSelfSend = 31,
  ZonaRosaErrorCodeInvalidKey = 40,
  ZonaRosaErrorCodeInvalidSignature = 41,
  ZonaRosaErrorCodeInvalidAttestationData = 42,
  ZonaRosaErrorCodeFingerprintVersionMismatch = 51,
  ZonaRosaErrorCodeFingerprintParsingError = 52,
  ZonaRosaErrorCodeUntrustedIdentity = 60,
  ZonaRosaErrorCodeInvalidKeyIdentifier = 70,
  ZonaRosaErrorCodeSessionNotFound = 80,
  ZonaRosaErrorCodeInvalidRegistrationId = 81,
  ZonaRosaErrorCodeInvalidSession = 82,
  ZonaRosaErrorCodeInvalidSenderKeySession = 83,
  ZonaRosaErrorCodeInvalidProtocolAddress = 84,
  ZonaRosaErrorCodeDuplicatedMessage = 90,
  ZonaRosaErrorCodeCallbackError = 100,
  ZonaRosaErrorCodeVerificationFailure = 110,
  ZonaRosaErrorCodeUsernameCannotBeEmpty = 120,
  ZonaRosaErrorCodeUsernameCannotStartWithDigit = 121,
  ZonaRosaErrorCodeUsernameMissingSeparator = 122,
  ZonaRosaErrorCodeUsernameBadDiscriminatorCharacter = 123,
  ZonaRosaErrorCodeUsernameBadNicknameCharacter = 124,
  ZonaRosaErrorCodeUsernameTooShort = 125,
  ZonaRosaErrorCodeUsernameTooLong = 126,
  ZonaRosaErrorCodeUsernameLinkInvalidEntropyDataLength = 127,
  ZonaRosaErrorCodeUsernameLinkInvalid = 128,
  ZonaRosaErrorCodeUsernameDiscriminatorCannotBeEmpty = 130,
  ZonaRosaErrorCodeUsernameDiscriminatorCannotBeZero = 131,
  ZonaRosaErrorCodeUsernameDiscriminatorCannotBeSingleDigit = 132,
  ZonaRosaErrorCodeUsernameDiscriminatorCannotHaveLeadingZeros = 133,
  ZonaRosaErrorCodeUsernameDiscriminatorTooLarge = 134,
  ZonaRosaErrorCodeIoError = 140,
  ZonaRosaErrorCodeInvalidMediaInput = 141,
  ZonaRosaErrorCodeUnsupportedMediaInput = 142,
  ZonaRosaErrorCodeConnectionTimedOut = 143,
  ZonaRosaErrorCodeNetworkProtocol = 144,
  ZonaRosaErrorCodeRateLimited = 145,
  ZonaRosaErrorCodeWebSocket = 146,
  ZonaRosaErrorCodeCdsiInvalidToken = 147,
  ZonaRosaErrorCodeConnectionFailed = 148,
  ZonaRosaErrorCodeChatServiceInactive = 149,
  ZonaRosaErrorCodeRequestTimedOut = 150,
  ZonaRosaErrorCodeRateLimitChallenge = 151,
  ZonaRosaErrorCodePossibleCaptiveNetwork = 152,
  ZonaRosaErrorCodeSvrDataMissing = 160,
  ZonaRosaErrorCodeSvrRestoreFailed = 161,
  ZonaRosaErrorCodeSvrRotationMachineTooManySteps = 162,
  ZonaRosaErrorCodeSvrRequestFailed = 163,
  ZonaRosaErrorCodeAppExpired = 170,
  ZonaRosaErrorCodeDeviceDeregistered = 171,
  ZonaRosaErrorCodeConnectionInvalidated = 172,
  ZonaRosaErrorCodeConnectedElsewhere = 173,
  ZonaRosaErrorCodeBackupValidation = 180,
  ZonaRosaErrorCodeRegistrationInvalidSessionId = 190,
  ZonaRosaErrorCodeRegistrationUnknown = 192,
  ZonaRosaErrorCodeRegistrationSessionNotFound = 193,
  ZonaRosaErrorCodeRegistrationNotReadyForVerification = 194,
  ZonaRosaErrorCodeRegistrationSendVerificationCodeFailed = 195,
  ZonaRosaErrorCodeRegistrationCodeNotDeliverable = 196,
  ZonaRosaErrorCodeRegistrationSessionUpdateRejected = 197,
  ZonaRosaErrorCodeRegistrationCredentialsCouldNotBeParsed = 198,
  ZonaRosaErrorCodeRegistrationDeviceTransferPossible = 199,
  ZonaRosaErrorCodeRegistrationRecoveryVerificationFailed = 200,
  ZonaRosaErrorCodeRegistrationLock = 201,
  ZonaRosaErrorCodeKeyTransparencyError = 210,
  ZonaRosaErrorCodeKeyTransparencyVerificationFailed = 211,
  ZonaRosaErrorCodeRequestUnauthorized = 220,
  ZonaRosaErrorCodeMismatchedDevices = 221,
} ZonaRosaErrorCode;

enum ZonaRosaSvr2CredentialsResult {
  ZonaRosaSvr2CredentialsResultMatch,
  ZonaRosaSvr2CredentialsResultNoMatch,
  ZonaRosaSvr2CredentialsResultInvalid,
};
typedef uint8_t ZonaRosaSvr2CredentialsResult;

typedef struct ZonaRosaAccountAttributes ZonaRosaAccountAttributes;

/**
 * A wrapper around [`ctr::Ctr32BE`] that uses a smaller nonce and supports an initial counter.
 */
typedef struct ZonaRosaAes256Ctr32 ZonaRosaAes256Ctr32;

typedef struct ZonaRosaAes256GcmDecryption ZonaRosaAes256GcmDecryption;

typedef struct ZonaRosaAes256GcmEncryption ZonaRosaAes256GcmEncryption;

typedef struct ZonaRosaAes256GcmSiv ZonaRosaAes256GcmSiv;

typedef struct ZonaRosaAuthenticatedChatConnection ZonaRosaAuthenticatedChatConnection;

typedef struct ZonaRosaBackupRestoreResponse ZonaRosaBackupRestoreResponse;

typedef struct ZonaRosaBackupStoreResponse ZonaRosaBackupStoreResponse;

typedef struct ZonaRosaBridgedStringMap ZonaRosaBridgedStringMap;

typedef struct ZonaRosaCdsiLookup ZonaRosaCdsiLookup;

typedef struct ZonaRosaCiphertextMessage ZonaRosaCiphertextMessage;

/**
 * Information about an established connection.
 */
typedef struct ZonaRosaConnectionInfo ZonaRosaConnectionInfo;

typedef struct ZonaRosaConnectionManager ZonaRosaConnectionManager;

typedef struct ZonaRosaConnectionProxyConfig ZonaRosaConnectionProxyConfig;

typedef struct ZonaRosaDecryptionErrorMessage ZonaRosaDecryptionErrorMessage;

typedef struct ZonaRosaFingerprint ZonaRosaFingerprint;

typedef struct ZonaRosaHsmEnclaveClient ZonaRosaHsmEnclaveClient;

typedef struct ZonaRosaHttpRequest ZonaRosaHttpRequest;

typedef struct ZonaRosaIncrementalMac ZonaRosaIncrementalMac;

typedef struct ZonaRosaKeyPair ZonaRosaKeyPair;

typedef struct ZonaRosaKeySecret ZonaRosaKeySecret;

typedef struct ZonaRosaKyberPreKeyRecord ZonaRosaKyberPreKeyRecord;

typedef struct ZonaRosaLookupRequest ZonaRosaLookupRequest;

typedef struct ZonaRosaMessageBackupKey ZonaRosaMessageBackupKey;

typedef struct ZonaRosaMessageBackupValidationOutcome ZonaRosaMessageBackupValidationOutcome;

typedef struct ZonaRosaOnlineBackupValidator ZonaRosaOnlineBackupValidator;

typedef struct ZonaRosaPinHash ZonaRosaPinHash;

typedef struct ZonaRosaPlaintextContent ZonaRosaPlaintextContent;

typedef struct ZonaRosaPreKeyBundle ZonaRosaPreKeyBundle;

typedef struct ZonaRosaPreKeyRecord ZonaRosaPreKeyRecord;

typedef struct ZonaRosaPreKeyZonaRosaMessage ZonaRosaPreKeyZonaRosaMessage;

typedef struct ZonaRosaPrivateKey ZonaRosaPrivateKey;

/**
 * Represents a unique ZonaRosa client instance as `(<user ID>, <device ID>)` pair.
 */
typedef struct ZonaRosaProtocolAddress ZonaRosaProtocolAddress;

typedef struct ZonaRosaProvisioningChatConnection ZonaRosaProvisioningChatConnection;

typedef struct ZonaRosaPublicKey ZonaRosaPublicKey;

typedef struct ZonaRosaRegisterAccountRequest ZonaRosaRegisterAccountRequest;

typedef struct ZonaRosaRegisterAccountResponse ZonaRosaRegisterAccountResponse;

typedef struct ZonaRosaRegistrationService ZonaRosaRegistrationService;

typedef struct ZonaRosaRegistrationSession ZonaRosaRegistrationSession;

typedef struct ZonaRosaSanitizedMetadata ZonaRosaSanitizedMetadata;

typedef struct ZonaRosaSenderCertificate ZonaRosaSenderCertificate;

typedef struct ZonaRosaSenderKeyDistributionMessage ZonaRosaSenderKeyDistributionMessage;

typedef struct ZonaRosaSenderKeyMessage ZonaRosaSenderKeyMessage;

typedef struct ZonaRosaSenderKeyRecord ZonaRosaSenderKeyRecord;

typedef struct ZonaRosaServerCertificate ZonaRosaServerCertificate;

/**
 * Wraps a named type and a single-use guard around [`chat::server_requests::ResponseEnvelopeSender`].
 */
typedef struct ZonaRosaServerMessageAck ZonaRosaServerMessageAck;

typedef struct ZonaRosaServerPublicParams ZonaRosaServerPublicParams;

typedef struct ZonaRosaServerSecretParams ZonaRosaServerSecretParams;

typedef struct ZonaRosaSessionRecord ZonaRosaSessionRecord;

typedef struct ZonaRosaSgxClientState ZonaRosaSgxClientState;

/**
 * The top-level error type (opaquely) returned to C clients when something goes wrong.
 *
 * Ideally this would use [ThinBox][], and then we wouldn't need an extra level of indirection when
 * returning it to C, but unfortunately that isn't stable yet.
 *
 * [ThinBox]: https://doc.rust-lang.org/std/boxed/struct.ThinBox.html
 */
typedef struct ZonaRosaFfiError ZonaRosaFfiError;

typedef struct ZonaRosaMessage ZonaRosaMessage;

typedef struct ZonaRosaSignedPreKeyRecord ZonaRosaSignedPreKeyRecord;

typedef struct ZonaRosaTokioAsyncContext ZonaRosaTokioAsyncContext;

typedef struct ZonaRosaUnauthenticatedChatConnection ZonaRosaUnauthenticatedChatConnection;

typedef struct ZonaRosaUnidentifiedSenderMessageContent ZonaRosaUnidentifiedSenderMessageContent;

typedef struct ZonaRosaValidatingMac ZonaRosaValidatingMac;

typedef struct {
  ZonaRosaProtocolAddress *raw;
} ZonaRosaMutPointerProtocolAddress;

typedef struct {
  const ZonaRosaProtocolAddress *raw;
} ZonaRosaConstPointerProtocolAddress;

typedef struct {
  ZonaRosaAes256Ctr32 *raw;
} ZonaRosaMutPointerAes256Ctr32;

typedef struct {
  const unsigned char *base;
  size_t length;
} ZonaRosaBorrowedBuffer;

typedef struct {
  unsigned char *base;
  size_t length;
} ZonaRosaBorrowedMutableBuffer;

typedef struct {
  ZonaRosaAes256GcmDecryption *raw;
} ZonaRosaMutPointerAes256GcmDecryption;

/**
 * A representation of a array allocated on the Rust heap for use in C code.
 */
typedef struct {
  unsigned char *base;
  /**
   * The number of elements in the buffer (not necessarily the number of bytes).
   */
  size_t length;
} ZonaRosaOwnedBuffer;

typedef struct {
  ZonaRosaAes256GcmEncryption *raw;
} ZonaRosaMutPointerAes256GcmEncryption;

typedef struct {
  const ZonaRosaAes256GcmSiv *raw;
} ZonaRosaConstPointerAes256GcmSiv;

typedef struct {
  ZonaRosaAes256GcmSiv *raw;
} ZonaRosaMutPointerAes256GcmSiv;

typedef struct {
  ZonaRosaAuthenticatedChatConnection *raw;
} ZonaRosaMutPointerAuthenticatedChatConnection;

typedef uint64_t ZonaRosaCancellationId;

/**
 * A C callback used to report the results of Rust futures.
 *
 * cbindgen will produce independent C types like `ZonaRosaCPromisei32` and
 * `ZonaRosaCPromiseProtocolAddress`.
 *
 * This derives Copy because it behaves like a C type; nevertheless, a promise should still only be
 * completed once.
 */
typedef struct {
  void (*complete)(ZonaRosaFfiError *error, const ZonaRosaMutPointerAuthenticatedChatConnection *result, const void *context);
  const void *context;
  ZonaRosaCancellationId cancellation_id;
} ZonaRosaCPromiseMutPointerAuthenticatedChatConnection;

typedef struct {
  const ZonaRosaTokioAsyncContext *raw;
} ZonaRosaConstPointerTokioAsyncContext;

typedef struct {
  const ZonaRosaConnectionManager *raw;
} ZonaRosaConstPointerConnectionManager;

typedef struct {
  const size_t *base;
  size_t length;
} ZonaRosaBorrowedSliceOfusize;

typedef struct {
  ZonaRosaBorrowedBuffer bytes;
  ZonaRosaBorrowedSliceOfusize lengths;
} ZonaRosaBorrowedBytestringArray;

/**
 * A C callback used to report the results of Rust futures.
 *
 * cbindgen will produce independent C types like `ZonaRosaCPromisei32` and
 * `ZonaRosaCPromiseProtocolAddress`.
 *
 * This derives Copy because it behaves like a C type; nevertheless, a promise should still only be
 * completed once.
 */
typedef struct {
  void (*complete)(ZonaRosaFfiError *error, const bool *result, const void *context);
  const void *context;
  ZonaRosaCancellationId cancellation_id;
} ZonaRosaCPromisebool;

typedef struct {
  const ZonaRosaAuthenticatedChatConnection *raw;
} ZonaRosaConstPointerAuthenticatedChatConnection;

typedef ZonaRosaConnectionInfo ZonaRosaChatConnectionInfo;

typedef struct {
  ZonaRosaChatConnectionInfo *raw;
} ZonaRosaMutPointerChatConnectionInfo;

typedef struct {
  ZonaRosaServerMessageAck *raw;
} ZonaRosaMutPointerServerMessageAck;

typedef int (*ZonaRosaFfiChatListenerReceivedIncomingMessage)(void *ctx, ZonaRosaOwnedBuffer envelope, uint64_t timestamp, ZonaRosaMutPointerServerMessageAck ack);

typedef int (*ZonaRosaFfiChatListenerReceivedQueueEmpty)(void *ctx);

/**
 * A representation of a array allocated on the Rust heap for use in C code.
 */
typedef struct {
  size_t *base;
  /**
   * The number of elements in the buffer (not necessarily the number of bytes).
   */
  size_t length;
} ZonaRosaOwnedBufferOfusize;

typedef struct {
  ZonaRosaOwnedBuffer bytes;
  ZonaRosaOwnedBufferOfusize lengths;
} ZonaRosaBytestringArray;

typedef ZonaRosaBytestringArray ZonaRosaStringArray;

typedef int (*ZonaRosaFfiChatListenerReceivedAlerts)(void *ctx, ZonaRosaStringArray alerts);

typedef int (*ZonaRosaFfiChatListenerConnectionInterrupted)(void *ctx, ZonaRosaFfiError *disconnect_cause);

typedef void (*ZonaRosaFfiChatListenerDestroy)(void *ctx);

typedef struct {
  void *ctx;
  ZonaRosaFfiChatListenerReceivedIncomingMessage received_incoming_message;
  ZonaRosaFfiChatListenerReceivedQueueEmpty received_queue_empty;
  ZonaRosaFfiChatListenerReceivedAlerts received_alerts;
  ZonaRosaFfiChatListenerConnectionInterrupted connection_interrupted;
  ZonaRosaFfiChatListenerDestroy destroy;
} ZonaRosaFfiChatListenerStruct;

typedef struct {
  const ZonaRosaFfiChatListenerStruct *raw;
} ZonaRosaConstPointerFfiChatListenerStruct;

/**
 * A type alias to be used with [`OwnedBufferOf`], so that `OwnedBufferOf<c_char>` and
 * `OwnedBufferOf<*const c_char>` get distinct names.
 */
typedef const char *ZonaRosaCStringPtr;

/**
 * A representation of a array allocated on the Rust heap for use in C code.
 */
typedef struct {
  ZonaRosaCStringPtr *base;
  /**
   * The number of elements in the buffer (not necessarily the number of bytes).
   */
  size_t length;
} ZonaRosaOwnedBufferOfCStringPtr;

typedef struct {
  uint16_t status;
  const char *message;
  ZonaRosaOwnedBufferOfCStringPtr headers;
  ZonaRosaOwnedBuffer body;
} ZonaRosaFfiChatResponse;

/**
 * A C callback used to report the results of Rust futures.
 *
 * cbindgen will produce independent C types like `ZonaRosaCPromisei32` and
 * `ZonaRosaCPromiseProtocolAddress`.
 *
 * This derives Copy because it behaves like a C type; nevertheless, a promise should still only be
 * completed once.
 */
typedef struct {
  void (*complete)(ZonaRosaFfiError *error, const ZonaRosaFfiChatResponse *result, const void *context);
  const void *context;
  ZonaRosaCancellationId cancellation_id;
} ZonaRosaCPromiseFfiChatResponse;

typedef struct {
  const ZonaRosaHttpRequest *raw;
} ZonaRosaConstPointerHttpRequest;

/**
 * A wrapper type for raw UUIDs, because C treats arrays specially in argument position.
 */
typedef struct {
  uint8_t bytes[16];
} ZonaRosaUuid;

/**
 * The fixed-width binary representation of a ServiceId.
 *
 * Rarely used. The variable-width format that privileges ACIs is preferred.
 */
typedef uint8_t ZonaRosaServiceIdFixedWidthBinaryBytes[17];

typedef struct {
  ZonaRosaPrivateKey *raw;
} ZonaRosaMutPointerPrivateKey;

typedef struct {
  ZonaRosaBackupRestoreResponse *raw;
} ZonaRosaMutPointerBackupRestoreResponse;

typedef struct {
  const ZonaRosaBackupRestoreResponse *raw;
} ZonaRosaConstPointerBackupRestoreResponse;

typedef struct {
  ZonaRosaBackupStoreResponse *raw;
} ZonaRosaMutPointerBackupStoreResponse;

typedef struct {
  const ZonaRosaBackupStoreResponse *raw;
} ZonaRosaConstPointerBackupStoreResponse;

typedef struct {
  ZonaRosaBridgedStringMap *raw;
} ZonaRosaMutPointerBridgedStringMap;

typedef struct {
  const ZonaRosaBridgedStringMap *raw;
} ZonaRosaConstPointerBridgedStringMap;

typedef struct {
  ZonaRosaSgxClientState *raw;
} ZonaRosaMutPointerSgxClientState;

typedef struct {
  /**
   * Telephone number, as an unformatted e164.
   */
  uint64_t e164;
  uint8_t rawAciUuid[16];
  uint8_t rawPniUuid[16];
} ZonaRosaFfiCdsiLookupResponseEntry;

/**
 * A representation of a array allocated on the Rust heap for use in C code.
 */
typedef struct {
  ZonaRosaFfiCdsiLookupResponseEntry *base;
  /**
   * The number of elements in the buffer (not necessarily the number of bytes).
   */
  size_t length;
} ZonaRosaOwnedBufferOfFfiCdsiLookupResponseEntry;

typedef struct {
  ZonaRosaOwnedBufferOfFfiCdsiLookupResponseEntry entries;
  int32_t debug_permits_used;
} ZonaRosaFfiCdsiLookupResponse;

/**
 * A C callback used to report the results of Rust futures.
 *
 * cbindgen will produce independent C types like `ZonaRosaCPromisei32` and
 * `ZonaRosaCPromiseProtocolAddress`.
 *
 * This derives Copy because it behaves like a C type; nevertheless, a promise should still only be
 * completed once.
 */
typedef struct {
  void (*complete)(ZonaRosaFfiError *error, const ZonaRosaFfiCdsiLookupResponse *result, const void *context);
  const void *context;
  ZonaRosaCancellationId cancellation_id;
} ZonaRosaCPromiseFfiCdsiLookupResponse;

typedef struct {
  const ZonaRosaCdsiLookup *raw;
} ZonaRosaConstPointerCdsiLookup;

typedef struct {
  ZonaRosaCdsiLookup *raw;
} ZonaRosaMutPointerCdsiLookup;

/**
 * A C callback used to report the results of Rust futures.
 *
 * cbindgen will produce independent C types like `ZonaRosaCPromisei32` and
 * `ZonaRosaCPromiseProtocolAddress`.
 *
 * This derives Copy because it behaves like a C type; nevertheless, a promise should still only be
 * completed once.
 */
typedef struct {
  void (*complete)(ZonaRosaFfiError *error, const ZonaRosaMutPointerCdsiLookup *result, const void *context);
  const void *context;
  ZonaRosaCancellationId cancellation_id;
} ZonaRosaCPromiseMutPointerCdsiLookup;

typedef struct {
  const ZonaRosaLookupRequest *raw;
} ZonaRosaConstPointerLookupRequest;

typedef struct {
  const ZonaRosaChatConnectionInfo *raw;
} ZonaRosaConstPointerChatConnectionInfo;

typedef struct {
  ZonaRosaCiphertextMessage *raw;
} ZonaRosaMutPointerCiphertextMessage;

typedef struct {
  const ZonaRosaPlaintextContent *raw;
} ZonaRosaConstPointerPlaintextContent;

typedef struct {
  const ZonaRosaCiphertextMessage *raw;
} ZonaRosaConstPointerCiphertextMessage;

typedef struct {
  ZonaRosaConnectionInfo *raw;
} ZonaRosaMutPointerConnectionInfo;

typedef struct {
  ZonaRosaConnectionManager *raw;
} ZonaRosaMutPointerConnectionManager;

typedef struct {
  const ZonaRosaConnectionProxyConfig *raw;
} ZonaRosaConstPointerConnectionProxyConfig;

typedef struct {
  ZonaRosaConnectionProxyConfig *raw;
} ZonaRosaMutPointerConnectionProxyConfig;

typedef struct {
  const ZonaRosaMessage *raw;
} ZonaRosaConstPointerZonaRosaMessage;

typedef struct {
  ZonaRosaSessionRecord *raw;
} ZonaRosaMutPointerSessionRecord;

typedef int (*ZonaRosaFfiBridgeSessionStoreLoadSession)(void *ctx, ZonaRosaMutPointerSessionRecord *out, ZonaRosaMutPointerProtocolAddress address);

typedef int (*ZonaRosaFfiBridgeSessionStoreStoreSession)(void *ctx, ZonaRosaMutPointerProtocolAddress address, ZonaRosaMutPointerSessionRecord record);

typedef void (*ZonaRosaFfiBridgeSessionStoreDestroy)(void *ctx);

typedef struct {
  void *ctx;
  ZonaRosaFfiBridgeSessionStoreLoadSession load_session;
  ZonaRosaFfiBridgeSessionStoreStoreSession store_session;
  ZonaRosaFfiBridgeSessionStoreDestroy destroy;
} ZonaRosaFfiBridgeSessionStoreStruct;

typedef ZonaRosaFfiBridgeSessionStoreStruct ZonaRosaSessionStore;

typedef struct {
  const ZonaRosaSessionStore *raw;
} ZonaRosaConstPointerFfiSessionStoreStruct;

typedef int (*ZonaRosaFfiBridgeIdentityKeyStoreGetLocalIdentityPrivateKey)(void *ctx, ZonaRosaMutPointerPrivateKey *out);

typedef int (*ZonaRosaFfiBridgeIdentityKeyStoreGetLocalRegistrationId)(void *ctx, uint32_t *out);

typedef struct {
  ZonaRosaPublicKey *raw;
} ZonaRosaMutPointerPublicKey;

typedef int (*ZonaRosaFfiBridgeIdentityKeyStoreGetIdentityKey)(void *ctx, ZonaRosaMutPointerPublicKey *out, ZonaRosaMutPointerProtocolAddress address);

typedef int (*ZonaRosaFfiBridgeIdentityKeyStoreSaveIdentityKey)(void *ctx, uint8_t *out, ZonaRosaMutPointerProtocolAddress address, ZonaRosaMutPointerPublicKey public_key);

typedef int (*ZonaRosaFfiBridgeIdentityKeyStoreIsTrustedIdentity)(void *ctx, bool *out, ZonaRosaMutPointerProtocolAddress address, ZonaRosaMutPointerPublicKey public_key, uint32_t direction);

typedef void (*ZonaRosaFfiBridgeIdentityKeyStoreDestroy)(void *ctx);

typedef struct {
  void *ctx;
  ZonaRosaFfiBridgeIdentityKeyStoreGetLocalIdentityPrivateKey get_local_identity_private_key;
  ZonaRosaFfiBridgeIdentityKeyStoreGetLocalRegistrationId get_local_registration_id;
  ZonaRosaFfiBridgeIdentityKeyStoreGetIdentityKey get_identity_key;
  ZonaRosaFfiBridgeIdentityKeyStoreSaveIdentityKey save_identity_key;
  ZonaRosaFfiBridgeIdentityKeyStoreIsTrustedIdentity is_trusted_identity;
  ZonaRosaFfiBridgeIdentityKeyStoreDestroy destroy;
} ZonaRosaFfiBridgeIdentityKeyStoreStruct;

typedef ZonaRosaFfiBridgeIdentityKeyStoreStruct ZonaRosaIdentityKeyStore;

typedef struct {
  const ZonaRosaIdentityKeyStore *raw;
} ZonaRosaConstPointerFfiIdentityKeyStoreStruct;

typedef struct {
  const ZonaRosaPreKeyZonaRosaMessage *raw;
} ZonaRosaConstPointerPreKeyZonaRosaMessage;

typedef struct {
  ZonaRosaPreKeyRecord *raw;
} ZonaRosaMutPointerPreKeyRecord;

typedef int (*ZonaRosaFfiBridgePreKeyStoreLoadPreKey)(void *ctx, ZonaRosaMutPointerPreKeyRecord *out, uint32_t id);

typedef int (*ZonaRosaFfiBridgePreKeyStoreStorePreKey)(void *ctx, uint32_t id, ZonaRosaMutPointerPreKeyRecord record);

typedef int (*ZonaRosaFfiBridgePreKeyStoreRemovePreKey)(void *ctx, uint32_t id);

typedef void (*ZonaRosaFfiBridgePreKeyStoreDestroy)(void *ctx);

typedef struct {
  void *ctx;
  ZonaRosaFfiBridgePreKeyStoreLoadPreKey load_pre_key;
  ZonaRosaFfiBridgePreKeyStoreStorePreKey store_pre_key;
  ZonaRosaFfiBridgePreKeyStoreRemovePreKey remove_pre_key;
  ZonaRosaFfiBridgePreKeyStoreDestroy destroy;
} ZonaRosaFfiBridgePreKeyStoreStruct;

typedef ZonaRosaFfiBridgePreKeyStoreStruct ZonaRosaPreKeyStore;

typedef struct {
  const ZonaRosaPreKeyStore *raw;
} ZonaRosaConstPointerFfiPreKeyStoreStruct;

typedef struct {
  ZonaRosaSignedPreKeyRecord *raw;
} ZonaRosaMutPointerSignedPreKeyRecord;

typedef int (*ZonaRosaFfiBridgeSignedPreKeyStoreLoadSignedPreKey)(void *ctx, ZonaRosaMutPointerSignedPreKeyRecord *out, uint32_t id);

typedef int (*ZonaRosaFfiBridgeSignedPreKeyStoreStoreSignedPreKey)(void *ctx, uint32_t id, ZonaRosaMutPointerSignedPreKeyRecord record);

typedef void (*ZonaRosaFfiBridgeSignedPreKeyStoreDestroy)(void *ctx);

typedef struct {
  void *ctx;
  ZonaRosaFfiBridgeSignedPreKeyStoreLoadSignedPreKey load_signed_pre_key;
  ZonaRosaFfiBridgeSignedPreKeyStoreStoreSignedPreKey store_signed_pre_key;
  ZonaRosaFfiBridgeSignedPreKeyStoreDestroy destroy;
} ZonaRosaFfiBridgeSignedPreKeyStoreStruct;

typedef ZonaRosaFfiBridgeSignedPreKeyStoreStruct ZonaRosaSignedPreKeyStore;

typedef struct {
  const ZonaRosaSignedPreKeyStore *raw;
} ZonaRosaConstPointerFfiSignedPreKeyStoreStruct;

typedef struct {
  ZonaRosaKyberPreKeyRecord *raw;
} ZonaRosaMutPointerKyberPreKeyRecord;

typedef int (*ZonaRosaFfiBridgeKyberPreKeyStoreLoadKyberPreKey)(void *ctx, ZonaRosaMutPointerKyberPreKeyRecord *out, uint32_t id);

typedef int (*ZonaRosaFfiBridgeKyberPreKeyStoreStoreKyberPreKey)(void *ctx, uint32_t id, ZonaRosaMutPointerKyberPreKeyRecord record);

typedef int (*ZonaRosaFfiBridgeKyberPreKeyStoreMarkKyberPreKeyUsed)(void *ctx, uint32_t id, uint32_t ec_prekey_id, ZonaRosaMutPointerPublicKey base_key);

typedef void (*ZonaRosaFfiBridgeKyberPreKeyStoreDestroy)(void *ctx);

typedef struct {
  void *ctx;
  ZonaRosaFfiBridgeKyberPreKeyStoreLoadKyberPreKey load_kyber_pre_key;
  ZonaRosaFfiBridgeKyberPreKeyStoreStoreKyberPreKey store_kyber_pre_key;
  ZonaRosaFfiBridgeKyberPreKeyStoreMarkKyberPreKeyUsed mark_kyber_pre_key_used;
  ZonaRosaFfiBridgeKyberPreKeyStoreDestroy destroy;
} ZonaRosaFfiBridgeKyberPreKeyStoreStruct;

typedef ZonaRosaFfiBridgeKyberPreKeyStoreStruct ZonaRosaKyberPreKeyStore;

typedef struct {
  const ZonaRosaKyberPreKeyStore *raw;
} ZonaRosaConstPointerFfiKyberPreKeyStoreStruct;

typedef struct {
  ZonaRosaDecryptionErrorMessage *raw;
} ZonaRosaMutPointerDecryptionErrorMessage;

typedef struct {
  const ZonaRosaDecryptionErrorMessage *raw;
} ZonaRosaConstPointerDecryptionErrorMessage;

/**
 * Like [`std::panic::AssertUnwindSafe`], but FFI-compatible.
 */
typedef const ZonaRosaFfiError *ZonaRosaUnwindSafeArgZonaRosaFfiError;

typedef struct {
  const char *first;
  uint32_t second;
} ZonaRosaPairOfc_charu32;

/**
 * A representation of a array allocated on the Rust heap for use in C code.
 */
typedef struct {
  uint32_t *base;
  /**
   * The number of elements in the buffer (not necessarily the number of bytes).
   */
  size_t length;
} ZonaRosaOwnedBufferOfu32;

typedef struct {
  ZonaRosaServiceIdFixedWidthBinaryBytes account;
  ZonaRosaOwnedBufferOfu32 missing_devices;
  ZonaRosaOwnedBufferOfu32 extra_devices;
  ZonaRosaOwnedBufferOfu32 stale_devices;
} ZonaRosaFfiMismatchedDevicesError;

/**
 * A representation of a array allocated on the Rust heap for use in C code.
 */
typedef struct {
  ZonaRosaFfiMismatchedDevicesError *base;
  /**
   * The number of elements in the buffer (not necessarily the number of bytes).
   */
  size_t length;
} ZonaRosaOwnedBufferOfFfiMismatchedDevicesError;

typedef struct {
  const char *first;
  ZonaRosaOwnedBuffer second;
} ZonaRosaPairOfc_charOwnedBufferOfc_uchar;

typedef struct {
  const char *first;
  bool second;
} ZonaRosaPairOfc_charbool;

typedef struct {
  ZonaRosaFingerprint *raw;
} ZonaRosaMutPointerFingerprint;

typedef struct {
  const ZonaRosaFingerprint *raw;
} ZonaRosaConstPointerFingerprint;

typedef struct {
  const ZonaRosaPublicKey *raw;
} ZonaRosaConstPointerPublicKey;

typedef struct {
  /**
   * The badge ID.
   */
  const char *id;
  /**
   * Whether the badge is currently configured to be visible.
   */
  bool visible;
  /**
   * When the badge expires.
   */
  double expiration_secs;
} ZonaRosaFfiRegisterResponseBadge;

/**
 * A representation of a array allocated on the Rust heap for use in C code.
 */
typedef struct {
  ZonaRosaFfiRegisterResponseBadge *base;
  /**
   * The number of elements in the buffer (not necessarily the number of bytes).
   */
  size_t length;
} ZonaRosaOwnedBufferOfFfiRegisterResponseBadge;

/**
 * A representation of a array allocated on the Rust heap for use in C code.
 */
typedef struct {
  ZonaRosaServiceIdFixedWidthBinaryBytes *base;
  /**
   * The number of elements in the buffer (not necessarily the number of bytes).
   */
  size_t length;
} ZonaRosaOwnedBufferOfServiceIdFixedWidthBinaryBytes;

typedef struct {
  ZonaRosaSenderKeyRecord *raw;
} ZonaRosaMutPointerSenderKeyRecord;

typedef int (*ZonaRosaFfiBridgeSenderKeyStoreLoadSenderKey)(void *ctx, ZonaRosaMutPointerSenderKeyRecord *out, ZonaRosaMutPointerProtocolAddress sender, ZonaRosaUuid distribution_id);

typedef int (*ZonaRosaFfiBridgeSenderKeyStoreStoreSenderKey)(void *ctx, ZonaRosaMutPointerProtocolAddress sender, ZonaRosaUuid distribution_id, ZonaRosaMutPointerSenderKeyRecord record);

typedef void (*ZonaRosaFfiBridgeSenderKeyStoreDestroy)(void *ctx);

typedef struct {
  void *ctx;
  ZonaRosaFfiBridgeSenderKeyStoreLoadSenderKey load_sender_key;
  ZonaRosaFfiBridgeSenderKeyStoreStoreSenderKey store_sender_key;
  ZonaRosaFfiBridgeSenderKeyStoreDestroy destroy;
} ZonaRosaFfiBridgeSenderKeyStoreStruct;

typedef ZonaRosaFfiBridgeSenderKeyStoreStruct ZonaRosaSenderKeyStore;

typedef struct {
  const ZonaRosaSenderKeyStore *raw;
} ZonaRosaConstPointerFfiSenderKeyStoreStruct;

typedef struct {
  const ZonaRosaServerSecretParams *raw;
} ZonaRosaConstPointerServerSecretParams;

typedef struct {
  const ZonaRosaBorrowedBuffer *base;
  size_t length;
} ZonaRosaBorrowedSliceOfBuffers;

typedef struct {
  const ZonaRosaServerPublicParams *raw;
} ZonaRosaConstPointerServerPublicParams;

typedef struct {
  ZonaRosaHsmEnclaveClient *raw;
} ZonaRosaMutPointerHsmEnclaveClient;

typedef struct {
  const ZonaRosaHsmEnclaveClient *raw;
} ZonaRosaConstPointerHsmEnclaveClient;

typedef struct {
  ZonaRosaHttpRequest *raw;
} ZonaRosaMutPointerHttpRequest;

typedef struct {
  ZonaRosaMutPointerPublicKey first;
  ZonaRosaMutPointerPrivateKey second;
} ZonaRosaPairOfMutPointerPublicKeyMutPointerPrivateKey;

typedef struct {
  const ZonaRosaPrivateKey *raw;
} ZonaRosaConstPointerPrivateKey;

typedef struct {
  ZonaRosaIncrementalMac *raw;
} ZonaRosaMutPointerIncrementalMac;

typedef void (*ZonaRosaLogCallback)(void *ctx, ZonaRosaLogLevel level, const char *file, uint32_t line, const char *message);

typedef void (*ZonaRosaLogFlushCallback)(void *ctx);

typedef struct {
  void *ctx;
  ZonaRosaLogCallback log;
  ZonaRosaLogFlushCallback flush;
} ZonaRosaFfiLogger;

/**
 * A C callback used to report the results of Rust futures.
 *
 * cbindgen will produce independent C types like `ZonaRosaCPromisei32` and
 * `ZonaRosaCPromiseProtocolAddress`.
 *
 * This derives Copy because it behaves like a C type; nevertheless, a promise should still only be
 * completed once.
 */
typedef struct {
  void (*complete)(ZonaRosaFfiError *error, const ZonaRosaOwnedBuffer *result, const void *context);
  const void *context;
  ZonaRosaCancellationId cancellation_id;
} ZonaRosaCPromiseOwnedBufferOfc_uchar;

typedef struct {
  const ZonaRosaUnauthenticatedChatConnection *raw;
} ZonaRosaConstPointerUnauthenticatedChatConnection;

typedef struct {
  bool present;
  ZonaRosaBorrowedBuffer value;
} ZonaRosaOptionalBorrowedSliceOfc_uchar;

typedef ZonaRosaKeyPair ZonaRosaKyberKeyPair;

typedef struct {
  ZonaRosaKyberKeyPair *raw;
} ZonaRosaMutPointerKyberKeyPair;

typedef struct {
  const ZonaRosaKyberKeyPair *raw;
} ZonaRosaConstPointerKyberKeyPair;

typedef ZonaRosaPublicKey ZonaRosaKyberPublicKey;

typedef struct {
  ZonaRosaKyberPublicKey *raw;
} ZonaRosaMutPointerKyberPublicKey;

/**
 * A KEM secret key with the ability to decapsulate a shared secret.
 */
typedef ZonaRosaKeySecret ZonaRosaSecretKey;

typedef ZonaRosaSecretKey ZonaRosaKyberSecretKey;

typedef struct {
  ZonaRosaKyberSecretKey *raw;
} ZonaRosaMutPointerKyberSecretKey;

typedef struct {
  const ZonaRosaKyberPreKeyRecord *raw;
} ZonaRosaConstPointerKyberPreKeyRecord;

typedef struct {
  const ZonaRosaKyberPublicKey *raw;
} ZonaRosaConstPointerKyberPublicKey;

typedef struct {
  const ZonaRosaKyberSecretKey *raw;
} ZonaRosaConstPointerKyberSecretKey;

typedef struct {
  ZonaRosaLookupRequest *raw;
} ZonaRosaMutPointerLookupRequest;

typedef struct {
  ZonaRosaMessageBackupKey *raw;
} ZonaRosaMutPointerMessageBackupKey;

typedef struct {
  const ZonaRosaMessageBackupKey *raw;
} ZonaRosaConstPointerMessageBackupKey;

typedef struct {
  ZonaRosaMessageBackupValidationOutcome *raw;
} ZonaRosaMutPointerMessageBackupValidationOutcome;

typedef struct {
  const ZonaRosaMessageBackupValidationOutcome *raw;
} ZonaRosaConstPointerMessageBackupValidationOutcome;

typedef int (*ZonaRosaFfiBridgeInputStreamRead)(void *ctx, size_t *out, ZonaRosaBorrowedMutableBuffer buf);

typedef int (*ZonaRosaFfiBridgeInputStreamSkip)(void *ctx, uint64_t amount);

typedef void (*ZonaRosaFfiBridgeInputStreamDestroy)(void *ctx);

typedef struct {
  void *ctx;
  ZonaRosaFfiBridgeInputStreamRead read;
  ZonaRosaFfiBridgeInputStreamSkip skip;
  ZonaRosaFfiBridgeInputStreamDestroy destroy;
} ZonaRosaFfiBridgeInputStreamStruct;

typedef ZonaRosaFfiBridgeInputStreamStruct ZonaRosaInputStream;

typedef struct {
  const ZonaRosaInputStream *raw;
} ZonaRosaConstPointerFfiInputStreamStruct;

typedef struct {
  ZonaRosaMessage *raw;
} ZonaRosaMutPointerZonaRosaMessage;

typedef struct {
  ZonaRosaSanitizedMetadata *raw;
} ZonaRosaMutPointerSanitizedMetadata;

typedef struct {
  ZonaRosaOnlineBackupValidator *raw;
} ZonaRosaMutPointerOnlineBackupValidator;

typedef struct {
  const ZonaRosaPinHash *raw;
} ZonaRosaConstPointerPinHash;

typedef struct {
  ZonaRosaPinHash *raw;
} ZonaRosaMutPointerPinHash;

typedef struct {
  ZonaRosaPlaintextContent *raw;
} ZonaRosaMutPointerPlaintextContent;

typedef struct {
  ZonaRosaPreKeyBundle *raw;
} ZonaRosaMutPointerPreKeyBundle;

typedef struct {
  const ZonaRosaPreKeyBundle *raw;
} ZonaRosaConstPointerPreKeyBundle;

typedef struct {
  const ZonaRosaPreKeyRecord *raw;
} ZonaRosaConstPointerPreKeyRecord;

typedef struct {
  ZonaRosaPreKeyZonaRosaMessage *raw;
} ZonaRosaMutPointerPreKeyZonaRosaMessage;

typedef struct {
  const ZonaRosaSenderKeyDistributionMessage *raw;
} ZonaRosaConstPointerSenderKeyDistributionMessage;

typedef struct {
  ZonaRosaProvisioningChatConnection *raw;
} ZonaRosaMutPointerProvisioningChatConnection;

/**
 * A C callback used to report the results of Rust futures.
 *
 * cbindgen will produce independent C types like `ZonaRosaCPromisei32` and
 * `ZonaRosaCPromiseProtocolAddress`.
 *
 * This derives Copy because it behaves like a C type; nevertheless, a promise should still only be
 * completed once.
 */
typedef struct {
  void (*complete)(ZonaRosaFfiError *error, const ZonaRosaMutPointerProvisioningChatConnection *result, const void *context);
  const void *context;
  ZonaRosaCancellationId cancellation_id;
} ZonaRosaCPromiseMutPointerProvisioningChatConnection;

typedef struct {
  const ZonaRosaProvisioningChatConnection *raw;
} ZonaRosaConstPointerProvisioningChatConnection;

typedef int (*ZonaRosaFfiProvisioningListenerReceivedAddress)(void *ctx, const char *address, ZonaRosaMutPointerServerMessageAck send_ack);

typedef int (*ZonaRosaFfiProvisioningListenerReceivedEnvelope)(void *ctx, ZonaRosaOwnedBuffer envelope, ZonaRosaMutPointerServerMessageAck send_ack);

typedef int (*ZonaRosaFfiProvisioningListenerConnectionInterrupted)(void *ctx, ZonaRosaFfiError *disconnect_cause);

typedef void (*ZonaRosaFfiProvisioningListenerDestroy)(void *ctx);

typedef struct {
  void *ctx;
  ZonaRosaFfiProvisioningListenerReceivedAddress received_address;
  ZonaRosaFfiProvisioningListenerReceivedEnvelope received_envelope;
  ZonaRosaFfiProvisioningListenerConnectionInterrupted connection_interrupted;
  ZonaRosaFfiProvisioningListenerDestroy destroy;
} ZonaRosaFfiProvisioningListenerStruct;

typedef struct {
  const ZonaRosaFfiProvisioningListenerStruct *raw;
} ZonaRosaConstPointerFfiProvisioningListenerStruct;

typedef struct {
  ZonaRosaRegisterAccountRequest *raw;
} ZonaRosaMutPointerRegisterAccountRequest;

typedef struct {
  const ZonaRosaRegisterAccountRequest *raw;
} ZonaRosaConstPointerRegisterAccountRequest;

typedef struct {
  uint32_t key_id;
  ZonaRosaFfiPublicKeyType public_key_type;
  const void *public_key;
  ZonaRosaBorrowedBuffer signature;
} ZonaRosaFfiSignedPublicPreKey;

typedef struct {
  ZonaRosaRegisterAccountResponse *raw;
} ZonaRosaMutPointerRegisterAccountResponse;

typedef struct {
  const ZonaRosaRegisterAccountResponse *raw;
} ZonaRosaConstPointerRegisterAccountResponse;

typedef struct {
  bool present;
  uint8_t bytes[16];
} ZonaRosaOptionalUuid;

typedef ZonaRosaAccountAttributes ZonaRosaRegistrationAccountAttributes;

typedef struct {
  ZonaRosaRegistrationAccountAttributes *raw;
} ZonaRosaMutPointerRegistrationAccountAttributes;

typedef struct {
  /**
   * Bridged as a string of bytes, but each entry is a UTF-8 `String` key
   * concatenated with a byte for the value.
   */
  ZonaRosaBytestringArray entries;
} ZonaRosaFfiCheckSvr2CredentialsResponse;

/**
 * A C callback used to report the results of Rust futures.
 *
 * cbindgen will produce independent C types like `ZonaRosaCPromisei32` and
 * `ZonaRosaCPromiseProtocolAddress`.
 *
 * This derives Copy because it behaves like a C type; nevertheless, a promise should still only be
 * completed once.
 */
typedef struct {
  void (*complete)(ZonaRosaFfiError *error, const ZonaRosaFfiCheckSvr2CredentialsResponse *result, const void *context);
  const void *context;
  ZonaRosaCancellationId cancellation_id;
} ZonaRosaCPromiseFfiCheckSvr2CredentialsResponse;

typedef struct {
  const ZonaRosaRegistrationService *raw;
} ZonaRosaConstPointerRegistrationService;

typedef struct {
  ZonaRosaRegistrationService *raw;
} ZonaRosaMutPointerRegistrationService;

/**
 * A C callback used to report the results of Rust futures.
 *
 * cbindgen will produce independent C types like `ZonaRosaCPromisei32` and
 * `ZonaRosaCPromiseProtocolAddress`.
 *
 * This derives Copy because it behaves like a C type; nevertheless, a promise should still only be
 * completed once.
 */
typedef struct {
  void (*complete)(ZonaRosaFfiError *error, const ZonaRosaMutPointerRegistrationService *result, const void *context);
  const void *context;
  ZonaRosaCancellationId cancellation_id;
} ZonaRosaCPromiseMutPointerRegistrationService;

typedef struct {
  const char *number;
  const char *push_token;
  const char *mcc;
  const char *mnc;
} ZonaRosaFfiRegistrationCreateSessionRequest;

typedef const ZonaRosaConnectionManager *(*ZonaRosaGetConnectChatConnectionManager)(void *ctx);

typedef void (*ZonaRosaDestroyConnectChatBridge)(void *ctx);

/**
 * A ref-counting pointer to a [`ConnectionManager`] and a callback to
 * decrement the count.
 */
typedef struct {
  void *ctx;
  ZonaRosaGetConnectChatConnectionManager get_connection_manager;
  ZonaRosaDestroyConnectChatBridge destroy;
} ZonaRosaFfiConnectChatBridgeStruct;

typedef struct {
  const ZonaRosaFfiConnectChatBridgeStruct *raw;
} ZonaRosaConstPointerFfiConnectChatBridgeStruct;

/**
 * A C callback used to report the results of Rust futures.
 *
 * cbindgen will produce independent C types like `ZonaRosaCPromisei32` and
 * `ZonaRosaCPromiseProtocolAddress`.
 *
 * This derives Copy because it behaves like a C type; nevertheless, a promise should still only be
 * completed once.
 */
typedef struct {
  void (*complete)(ZonaRosaFfiError *error, const ZonaRosaMutPointerRegisterAccountResponse *result, const void *context);
  const void *context;
  ZonaRosaCancellationId cancellation_id;
} ZonaRosaCPromiseMutPointerRegisterAccountResponse;

typedef struct {
  const ZonaRosaRegistrationAccountAttributes *raw;
} ZonaRosaConstPointerRegistrationAccountAttributes;

typedef struct {
  ZonaRosaRegistrationSession *raw;
} ZonaRosaMutPointerRegistrationSession;

typedef struct {
  const ZonaRosaRegistrationSession *raw;
} ZonaRosaConstPointerRegistrationSession;

typedef struct {
  const ZonaRosaSanitizedMetadata *raw;
} ZonaRosaConstPointerSanitizedMetadata;

typedef struct {
  const ZonaRosaConstPointerProtocolAddress *base;
  size_t length;
} ZonaRosaBorrowedSliceOfConstPointerProtocolAddress;

typedef struct {
  const ZonaRosaSessionRecord *raw;
} ZonaRosaConstPointerSessionRecord;

typedef struct {
  const ZonaRosaConstPointerSessionRecord *base;
  size_t length;
} ZonaRosaBorrowedSliceOfConstPointerSessionRecord;

typedef struct {
  const ZonaRosaUnidentifiedSenderMessageContent *raw;
} ZonaRosaConstPointerUnidentifiedSenderMessageContent;

typedef struct {
  ZonaRosaUnidentifiedSenderMessageContent *raw;
} ZonaRosaMutPointerUnidentifiedSenderMessageContent;

typedef uint8_t ZonaRosaBackupKeyBytes[ZonaRosaBACKUP_KEY_LEN];

/**
 * A C callback used to report the results of Rust futures.
 *
 * cbindgen will produce independent C types like `ZonaRosaCPromisei32` and
 * `ZonaRosaCPromiseProtocolAddress`.
 *
 * This derives Copy because it behaves like a C type; nevertheless, a promise should still only be
 * completed once.
 */
typedef struct {
  void (*complete)(ZonaRosaFfiError *error, const ZonaRosaMutPointerBackupRestoreResponse *result, const void *context);
  const void *context;
  ZonaRosaCancellationId cancellation_id;
} ZonaRosaCPromiseMutPointerBackupRestoreResponse;

/**
 * A C callback used to report the results of Rust futures.
 *
 * cbindgen will produce independent C types like `ZonaRosaCPromisei32` and
 * `ZonaRosaCPromiseProtocolAddress`.
 *
 * This derives Copy because it behaves like a C type; nevertheless, a promise should still only be
 * completed once.
 */
typedef struct {
  void (*complete)(ZonaRosaFfiError *error, const ZonaRosaMutPointerBackupStoreResponse *result, const void *context);
  const void *context;
  ZonaRosaCancellationId cancellation_id;
} ZonaRosaCPromiseMutPointerBackupStoreResponse;

typedef struct {
  ZonaRosaSenderCertificate *raw;
} ZonaRosaMutPointerSenderCertificate;

typedef struct {
  const ZonaRosaSenderCertificate *raw;
} ZonaRosaConstPointerSenderCertificate;

typedef struct {
  ZonaRosaServerCertificate *raw;
} ZonaRosaMutPointerServerCertificate;

typedef struct {
  const ZonaRosaServerCertificate *raw;
} ZonaRosaConstPointerServerCertificate;

typedef struct {
  const ZonaRosaConstPointerPublicKey *base;
  size_t length;
} ZonaRosaBorrowedSliceOfConstPointerPublicKey;

typedef struct {
  ZonaRosaSenderKeyDistributionMessage *raw;
} ZonaRosaMutPointerSenderKeyDistributionMessage;

typedef struct {
  ZonaRosaSenderKeyMessage *raw;
} ZonaRosaMutPointerSenderKeyMessage;

typedef struct {
  const ZonaRosaSenderKeyMessage *raw;
} ZonaRosaConstPointerSenderKeyMessage;

typedef struct {
  const ZonaRosaSenderKeyRecord *raw;
} ZonaRosaConstPointerSenderKeyRecord;

typedef struct {
  const ZonaRosaServerMessageAck *raw;
} ZonaRosaConstPointerServerMessageAck;

typedef struct {
  ZonaRosaServerPublicParams *raw;
} ZonaRosaMutPointerServerPublicParams;

typedef struct {
  ZonaRosaServerSecretParams *raw;
} ZonaRosaMutPointerServerSecretParams;

typedef struct {
  const ZonaRosaSgxClientState *raw;
} ZonaRosaConstPointerSgxClientState;

typedef struct {
  const ZonaRosaSignedPreKeyRecord *raw;
} ZonaRosaConstPointerSignedPreKeyRecord;

typedef struct {
  ZonaRosaTokioAsyncContext *raw;
} ZonaRosaMutPointerTokioAsyncContext;

typedef struct {
  ZonaRosaUnauthenticatedChatConnection *raw;
} ZonaRosaMutPointerUnauthenticatedChatConnection;

/**
 * A C callback used to report the results of Rust futures.
 *
 * cbindgen will produce independent C types like `ZonaRosaCPromisei32` and
 * `ZonaRosaCPromiseProtocolAddress`.
 *
 * This derives Copy because it behaves like a C type; nevertheless, a promise should still only be
 * completed once.
 */
typedef struct {
  void (*complete)(ZonaRosaFfiError *error, const ZonaRosaMutPointerUnauthenticatedChatConnection *result, const void *context);
  const void *context;
  ZonaRosaCancellationId cancellation_id;
} ZonaRosaCPromiseMutPointerUnauthenticatedChatConnection;

/**
 * A C callback used to report the results of Rust futures.
 *
 * cbindgen will produce independent C types like `ZonaRosaCPromisei32` and
 * `ZonaRosaCPromiseProtocolAddress`.
 *
 * This derives Copy because it behaves like a C type; nevertheless, a promise should still only be
 * completed once.
 */
typedef struct {
  void (*complete)(ZonaRosaFfiError *error, const ZonaRosaOptionalUuid *result, const void *context);
  const void *context;
  ZonaRosaCancellationId cancellation_id;
} ZonaRosaCPromiseOptionalUuid;

typedef struct {
  bool present;
  const char *first;
  uint8_t second[32];
} ZonaRosaOptionalPairOfc_charu832;

/**
 * A C callback used to report the results of Rust futures.
 *
 * cbindgen will produce independent C types like `ZonaRosaCPromisei32` and
 * `ZonaRosaCPromiseProtocolAddress`.
 *
 * This derives Copy because it behaves like a C type; nevertheless, a promise should still only be
 * completed once.
 */
typedef struct {
  void (*complete)(ZonaRosaFfiError *error, const ZonaRosaOptionalPairOfc_charu832 *result, const void *context);
  const void *context;
  ZonaRosaCancellationId cancellation_id;
} ZonaRosaCPromiseOptionalPairOfc_charu832;

/**
 * A C callback used to report the results of Rust futures.
 *
 * cbindgen will produce independent C types like `ZonaRosaCPromisei32` and
 * `ZonaRosaCPromiseProtocolAddress`.
 *
 * This derives Copy because it behaves like a C type; nevertheless, a promise should still only be
 * completed once.
 */
typedef struct {
  void (*complete)(ZonaRosaFfiError *error, const ZonaRosaOwnedBufferOfServiceIdFixedWidthBinaryBytes *result, const void *context);
  const void *context;
  ZonaRosaCancellationId cancellation_id;
} ZonaRosaCPromiseOwnedBufferOfServiceIdFixedWidthBinaryBytes;

typedef struct {
  ZonaRosaValidatingMac *raw;
} ZonaRosaMutPointerValidatingMac;

typedef ZonaRosaFfiBridgeInputStreamStruct ZonaRosaFfiBridgeSyncInputStreamStruct;

typedef ZonaRosaFfiBridgeSyncInputStreamStruct ZonaRosaSyncInputStream;

typedef struct {
  const ZonaRosaSyncInputStream *raw;
} ZonaRosaConstPointerFfiSyncInputStreamStruct;

typedef uint8_t ZonaRosaRandomnessBytes[ZonaRosaRANDOMNESS_LEN];

typedef uint8_t ZonaRosaUnidentifiedAccessKey[ZonaRosaACCESS_KEY_LEN];



ZonaRosaFfiError *zonarosa_account_entropy_pool_derive_backup_key(uint8_t (*out)[ZonaRosaBACKUP_KEY_LEN], const char *account_entropy);

ZonaRosaFfiError *zonarosa_account_entropy_pool_derive_svr_key(uint8_t (*out)[ZonaRosaSVR_KEY_LEN], const char *account_entropy);

ZonaRosaFfiError *zonarosa_account_entropy_pool_generate(const char **out);

ZonaRosaFfiError *zonarosa_account_entropy_pool_is_valid(bool *out, const char *account_entropy);

ZonaRosaFfiError *zonarosa_address_clone(ZonaRosaMutPointerProtocolAddress *new_obj, ZonaRosaConstPointerProtocolAddress obj);

ZonaRosaFfiError *zonarosa_address_destroy(ZonaRosaMutPointerProtocolAddress p);

ZonaRosaFfiError *zonarosa_address_get_device_id(uint32_t *out, ZonaRosaConstPointerProtocolAddress obj);

ZonaRosaFfiError *zonarosa_address_get_name(const char **out, ZonaRosaConstPointerProtocolAddress obj);

ZonaRosaFfiError *zonarosa_address_new(ZonaRosaMutPointerProtocolAddress *out, const char *name, uint32_t device_id);

ZonaRosaFfiError *zonarosa_aes256_ctr32_destroy(ZonaRosaMutPointerAes256Ctr32 p);

ZonaRosaFfiError *zonarosa_aes256_ctr32_new(ZonaRosaMutPointerAes256Ctr32 *out, ZonaRosaBorrowedBuffer key, ZonaRosaBorrowedBuffer nonce, uint32_t initial_ctr);

ZonaRosaFfiError *zonarosa_aes256_ctr32_process(ZonaRosaMutPointerAes256Ctr32 ctr, ZonaRosaBorrowedMutableBuffer data, uint32_t offset, uint32_t length);

ZonaRosaFfiError *zonarosa_aes256_gcm_decryption_destroy(ZonaRosaMutPointerAes256GcmDecryption p);

ZonaRosaFfiError *zonarosa_aes256_gcm_decryption_new(ZonaRosaMutPointerAes256GcmDecryption *out, ZonaRosaBorrowedBuffer key, ZonaRosaBorrowedBuffer nonce, ZonaRosaBorrowedBuffer associated_data);

ZonaRosaFfiError *zonarosa_aes256_gcm_decryption_update(ZonaRosaMutPointerAes256GcmDecryption gcm, ZonaRosaBorrowedMutableBuffer data, uint32_t offset, uint32_t length);

ZonaRosaFfiError *zonarosa_aes256_gcm_decryption_verify_tag(bool *out, ZonaRosaMutPointerAes256GcmDecryption gcm, ZonaRosaBorrowedBuffer tag);

ZonaRosaFfiError *zonarosa_aes256_gcm_encryption_compute_tag(ZonaRosaOwnedBuffer *out, ZonaRosaMutPointerAes256GcmEncryption gcm);

ZonaRosaFfiError *zonarosa_aes256_gcm_encryption_destroy(ZonaRosaMutPointerAes256GcmEncryption p);

ZonaRosaFfiError *zonarosa_aes256_gcm_encryption_new(ZonaRosaMutPointerAes256GcmEncryption *out, ZonaRosaBorrowedBuffer key, ZonaRosaBorrowedBuffer nonce, ZonaRosaBorrowedBuffer associated_data);

ZonaRosaFfiError *zonarosa_aes256_gcm_encryption_update(ZonaRosaMutPointerAes256GcmEncryption gcm, ZonaRosaBorrowedMutableBuffer data, uint32_t offset, uint32_t length);

ZonaRosaFfiError *zonarosa_aes256_gcm_siv_decrypt(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerAes256GcmSiv aes_gcm_siv, ZonaRosaBorrowedBuffer ctext, ZonaRosaBorrowedBuffer nonce, ZonaRosaBorrowedBuffer associated_data);

ZonaRosaFfiError *zonarosa_aes256_gcm_siv_destroy(ZonaRosaMutPointerAes256GcmSiv p);

ZonaRosaFfiError *zonarosa_aes256_gcm_siv_encrypt(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerAes256GcmSiv aes_gcm_siv_obj, ZonaRosaBorrowedBuffer ptext, ZonaRosaBorrowedBuffer nonce, ZonaRosaBorrowedBuffer associated_data);

ZonaRosaFfiError *zonarosa_aes256_gcm_siv_new(ZonaRosaMutPointerAes256GcmSiv *out, ZonaRosaBorrowedBuffer key);

ZonaRosaFfiError *zonarosa_auth_credential_presentation_check_valid_contents(ZonaRosaBorrowedBuffer presentation_bytes);

ZonaRosaFfiError *zonarosa_auth_credential_presentation_get_pni_ciphertext(unsigned char (*out)[ZonaRosaUUID_CIPHERTEXT_LEN], ZonaRosaBorrowedBuffer presentation_bytes);

ZonaRosaFfiError *zonarosa_auth_credential_presentation_get_redemption_time(uint64_t *out, ZonaRosaBorrowedBuffer presentation_bytes);

ZonaRosaFfiError *zonarosa_auth_credential_presentation_get_uuid_ciphertext(unsigned char (*out)[ZonaRosaUUID_CIPHERTEXT_LEN], ZonaRosaBorrowedBuffer presentation_bytes);

ZonaRosaFfiError *zonarosa_auth_credential_with_pni_check_valid_contents(ZonaRosaBorrowedBuffer bytes);

ZonaRosaFfiError *zonarosa_auth_credential_with_pni_response_check_valid_contents(ZonaRosaBorrowedBuffer bytes);

ZonaRosaFfiError *zonarosa_authenticated_chat_connection_connect(ZonaRosaCPromiseMutPointerAuthenticatedChatConnection *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, ZonaRosaConstPointerConnectionManager connection_manager, const char *username, const char *password, bool receive_stories, ZonaRosaBorrowedBytestringArray languages);

ZonaRosaFfiError *zonarosa_authenticated_chat_connection_destroy(ZonaRosaMutPointerAuthenticatedChatConnection p);

ZonaRosaFfiError *zonarosa_authenticated_chat_connection_disconnect(ZonaRosaCPromisebool *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, ZonaRosaConstPointerAuthenticatedChatConnection chat);

ZonaRosaFfiError *zonarosa_authenticated_chat_connection_info(ZonaRosaMutPointerChatConnectionInfo *out, ZonaRosaConstPointerAuthenticatedChatConnection chat);

ZonaRosaFfiError *zonarosa_authenticated_chat_connection_init_listener(ZonaRosaConstPointerAuthenticatedChatConnection chat, ZonaRosaConstPointerFfiChatListenerStruct listener);

ZonaRosaFfiError *zonarosa_authenticated_chat_connection_preconnect(ZonaRosaCPromisebool *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, ZonaRosaConstPointerConnectionManager connection_manager);

ZonaRosaFfiError *zonarosa_authenticated_chat_connection_send(ZonaRosaCPromiseFfiChatResponse *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, ZonaRosaConstPointerAuthenticatedChatConnection chat, ZonaRosaConstPointerHttpRequest http_request, uint32_t timeout_millis);

ZonaRosaFfiError *zonarosa_backup_auth_credential_check_valid_contents(ZonaRosaBorrowedBuffer params_bytes);

ZonaRosaFfiError *zonarosa_backup_auth_credential_get_backup_id(uint8_t (*out)[16], ZonaRosaBorrowedBuffer credential_bytes);

ZonaRosaFfiError *zonarosa_backup_auth_credential_get_backup_level(uint8_t *out, ZonaRosaBorrowedBuffer credential_bytes);

ZonaRosaFfiError *zonarosa_backup_auth_credential_get_type(uint8_t *out, ZonaRosaBorrowedBuffer credential_bytes);

ZonaRosaFfiError *zonarosa_backup_auth_credential_present_deterministic(ZonaRosaOwnedBuffer *out, ZonaRosaBorrowedBuffer credential_bytes, ZonaRosaBorrowedBuffer server_params_bytes, const uint8_t (*randomness)[ZonaRosaRANDOMNESS_LEN]);

ZonaRosaFfiError *zonarosa_backup_auth_credential_presentation_check_valid_contents(ZonaRosaBorrowedBuffer presentation_bytes);

ZonaRosaFfiError *zonarosa_backup_auth_credential_presentation_verify(ZonaRosaBorrowedBuffer presentation_bytes, uint64_t now, ZonaRosaBorrowedBuffer server_params_bytes);

ZonaRosaFfiError *zonarosa_backup_auth_credential_request_check_valid_contents(ZonaRosaBorrowedBuffer request_bytes);

ZonaRosaFfiError *zonarosa_backup_auth_credential_request_context_check_valid_contents(ZonaRosaBorrowedBuffer context_bytes);

ZonaRosaFfiError *zonarosa_backup_auth_credential_request_context_get_request(ZonaRosaOwnedBuffer *out, ZonaRosaBorrowedBuffer context_bytes);

ZonaRosaFfiError *zonarosa_backup_auth_credential_request_context_new(ZonaRosaOwnedBuffer *out, const uint8_t (*backup_key)[32], ZonaRosaUuid uuid);

ZonaRosaFfiError *zonarosa_backup_auth_credential_request_context_receive_response(ZonaRosaOwnedBuffer *out, ZonaRosaBorrowedBuffer context_bytes, ZonaRosaBorrowedBuffer response_bytes, uint64_t expected_redemption_time, ZonaRosaBorrowedBuffer params_bytes);

ZonaRosaFfiError *zonarosa_backup_auth_credential_request_issue_deterministic(ZonaRosaOwnedBuffer *out, ZonaRosaBorrowedBuffer request_bytes, uint64_t redemption_time, uint8_t backup_level, uint8_t credential_type, ZonaRosaBorrowedBuffer params_bytes, const uint8_t (*randomness)[ZonaRosaRANDOMNESS_LEN]);

ZonaRosaFfiError *zonarosa_backup_auth_credential_response_check_valid_contents(ZonaRosaBorrowedBuffer response_bytes);

ZonaRosaFfiError *zonarosa_backup_key_derive_backup_id(uint8_t (*out)[16], const uint8_t (*backup_key)[ZonaRosaBACKUP_KEY_LEN], const ZonaRosaServiceIdFixedWidthBinaryBytes *aci);

ZonaRosaFfiError *zonarosa_backup_key_derive_ec_key(ZonaRosaMutPointerPrivateKey *out, const uint8_t (*backup_key)[ZonaRosaBACKUP_KEY_LEN], const ZonaRosaServiceIdFixedWidthBinaryBytes *aci);

ZonaRosaFfiError *zonarosa_backup_key_derive_local_backup_metadata_key(uint8_t (*out)[ZonaRosaLOCAL_BACKUP_METADATA_KEY_LEN], const uint8_t (*backup_key)[ZonaRosaBACKUP_KEY_LEN]);

ZonaRosaFfiError *zonarosa_backup_key_derive_media_encryption_key(uint8_t (*out)[ZonaRosaMEDIA_ENCRYPTION_KEY_LEN], const uint8_t (*backup_key)[ZonaRosaBACKUP_KEY_LEN], const uint8_t (*media_id)[ZonaRosaMEDIA_ID_LEN]);

ZonaRosaFfiError *zonarosa_backup_key_derive_media_id(uint8_t (*out)[ZonaRosaMEDIA_ID_LEN], const uint8_t (*backup_key)[ZonaRosaBACKUP_KEY_LEN], const char *media_name);

ZonaRosaFfiError *zonarosa_backup_key_derive_thumbnail_transit_encryption_key(uint8_t (*out)[ZonaRosaMEDIA_ENCRYPTION_KEY_LEN], const uint8_t (*backup_key)[ZonaRosaBACKUP_KEY_LEN], const uint8_t (*media_id)[ZonaRosaMEDIA_ID_LEN]);

ZonaRosaFfiError *zonarosa_backup_restore_response_destroy(ZonaRosaMutPointerBackupRestoreResponse p);

ZonaRosaFfiError *zonarosa_backup_restore_response_get_forward_secrecy_token(uint8_t (*out)[ZonaRosaBACKUP_FORWARD_SECRECY_TOKEN_LEN], ZonaRosaConstPointerBackupRestoreResponse response);

ZonaRosaFfiError *zonarosa_backup_restore_response_get_next_backup_secret_data(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerBackupRestoreResponse response);

ZonaRosaFfiError *zonarosa_backup_store_response_destroy(ZonaRosaMutPointerBackupStoreResponse p);

ZonaRosaFfiError *zonarosa_backup_store_response_get_forward_secrecy_token(uint8_t (*out)[ZonaRosaBACKUP_FORWARD_SECRECY_TOKEN_LEN], ZonaRosaConstPointerBackupStoreResponse response);

ZonaRosaFfiError *zonarosa_backup_store_response_get_next_backup_secret_data(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerBackupStoreResponse response);

ZonaRosaFfiError *zonarosa_backup_store_response_get_opaque_metadata(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerBackupStoreResponse response);

ZonaRosaFfiError *zonarosa_bridged_string_map_clone(ZonaRosaMutPointerBridgedStringMap *new_obj, ZonaRosaConstPointerBridgedStringMap obj);

ZonaRosaFfiError *zonarosa_bridged_string_map_destroy(ZonaRosaMutPointerBridgedStringMap p);

ZonaRosaFfiError *zonarosa_bridged_string_map_insert(ZonaRosaMutPointerBridgedStringMap map, const char *key, const char *value);

ZonaRosaFfiError *zonarosa_bridged_string_map_new(ZonaRosaMutPointerBridgedStringMap *out, uint32_t initial_capacity);

ZonaRosaFfiError *zonarosa_call_link_auth_credential_check_valid_contents(ZonaRosaBorrowedBuffer credential_bytes);

ZonaRosaFfiError *zonarosa_call_link_auth_credential_present_deterministic(ZonaRosaOwnedBuffer *out, ZonaRosaBorrowedBuffer credential_bytes, const ZonaRosaServiceIdFixedWidthBinaryBytes *user_id, uint64_t redemption_time, ZonaRosaBorrowedBuffer server_params_bytes, ZonaRosaBorrowedBuffer call_link_params_bytes, const uint8_t (*randomness)[ZonaRosaRANDOMNESS_LEN]);

ZonaRosaFfiError *zonarosa_call_link_auth_credential_presentation_check_valid_contents(ZonaRosaBorrowedBuffer presentation_bytes);

ZonaRosaFfiError *zonarosa_call_link_auth_credential_presentation_get_user_id(unsigned char (*out)[ZonaRosaUUID_CIPHERTEXT_LEN], ZonaRosaBorrowedBuffer presentation_bytes);

ZonaRosaFfiError *zonarosa_call_link_auth_credential_presentation_verify(ZonaRosaBorrowedBuffer presentation_bytes, uint64_t now, ZonaRosaBorrowedBuffer server_params_bytes, ZonaRosaBorrowedBuffer call_link_params_bytes);

ZonaRosaFfiError *zonarosa_call_link_auth_credential_response_check_valid_contents(ZonaRosaBorrowedBuffer response_bytes);

ZonaRosaFfiError *zonarosa_call_link_auth_credential_response_issue_deterministic(ZonaRosaOwnedBuffer *out, const ZonaRosaServiceIdFixedWidthBinaryBytes *user_id, uint64_t redemption_time, ZonaRosaBorrowedBuffer params_bytes, const uint8_t (*randomness)[ZonaRosaRANDOMNESS_LEN]);

ZonaRosaFfiError *zonarosa_call_link_auth_credential_response_receive(ZonaRosaOwnedBuffer *out, ZonaRosaBorrowedBuffer response_bytes, const ZonaRosaServiceIdFixedWidthBinaryBytes *user_id, uint64_t redemption_time, ZonaRosaBorrowedBuffer params_bytes);

ZonaRosaFfiError *zonarosa_call_link_public_params_check_valid_contents(ZonaRosaBorrowedBuffer params_bytes);

ZonaRosaFfiError *zonarosa_call_link_secret_params_check_valid_contents(ZonaRosaBorrowedBuffer params_bytes);

ZonaRosaFfiError *zonarosa_call_link_secret_params_decrypt_user_id(ZonaRosaServiceIdFixedWidthBinaryBytes *out, ZonaRosaBorrowedBuffer params_bytes, const unsigned char (*user_id)[ZonaRosaUUID_CIPHERTEXT_LEN]);

ZonaRosaFfiError *zonarosa_call_link_secret_params_derive_from_root_key(ZonaRosaOwnedBuffer *out, ZonaRosaBorrowedBuffer root_key);

ZonaRosaFfiError *zonarosa_call_link_secret_params_encrypt_user_id(unsigned char (*out)[ZonaRosaUUID_CIPHERTEXT_LEN], ZonaRosaBorrowedBuffer params_bytes, const ZonaRosaServiceIdFixedWidthBinaryBytes *user_id);

ZonaRosaFfiError *zonarosa_call_link_secret_params_get_public_params(ZonaRosaOwnedBuffer *out, ZonaRosaBorrowedBuffer params_bytes);

ZonaRosaFfiError *zonarosa_cds2_client_state_new(ZonaRosaMutPointerSgxClientState *out, ZonaRosaBorrowedBuffer mrenclave, ZonaRosaBorrowedBuffer attestation_msg, uint64_t current_timestamp);

ZonaRosaFfiError *zonarosa_cdsi_lookup_complete(ZonaRosaCPromiseFfiCdsiLookupResponse *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, ZonaRosaConstPointerCdsiLookup lookup);

ZonaRosaFfiError *zonarosa_cdsi_lookup_destroy(ZonaRosaMutPointerCdsiLookup p);

ZonaRosaFfiError *zonarosa_cdsi_lookup_new(ZonaRosaCPromiseMutPointerCdsiLookup *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, ZonaRosaConstPointerConnectionManager connection_manager, const char *username, const char *password, ZonaRosaConstPointerLookupRequest request);

ZonaRosaFfiError *zonarosa_cdsi_lookup_token(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerCdsiLookup lookup);

ZonaRosaFfiError *zonarosa_chat_connection_info_description(const char **out, ZonaRosaConstPointerChatConnectionInfo connection_info);

ZonaRosaFfiError *zonarosa_chat_connection_info_ip_version(uint8_t *out, ZonaRosaConstPointerChatConnectionInfo connection_info);

ZonaRosaFfiError *zonarosa_chat_connection_info_local_port(uint16_t *out, ZonaRosaConstPointerChatConnectionInfo connection_info);

ZonaRosaFfiError *zonarosa_ciphertext_message_destroy(ZonaRosaMutPointerCiphertextMessage p);

ZonaRosaFfiError *zonarosa_ciphertext_message_from_plaintext_content(ZonaRosaMutPointerCiphertextMessage *out, ZonaRosaConstPointerPlaintextContent m);

ZonaRosaFfiError *zonarosa_ciphertext_message_serialize(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerCiphertextMessage obj);

ZonaRosaFfiError *zonarosa_ciphertext_message_type(uint8_t *out, ZonaRosaConstPointerCiphertextMessage msg);

ZonaRosaFfiError *zonarosa_connection_info_destroy(ZonaRosaMutPointerConnectionInfo p);

ZonaRosaFfiError *zonarosa_connection_manager_clear_proxy(ZonaRosaConstPointerConnectionManager connection_manager);

ZonaRosaFfiError *zonarosa_connection_manager_destroy(ZonaRosaMutPointerConnectionManager p);

ZonaRosaFfiError *zonarosa_connection_manager_new(ZonaRosaMutPointerConnectionManager *out, uint8_t environment, const char *user_agent, ZonaRosaMutPointerBridgedStringMap remote_config, uint8_t build_variant);

ZonaRosaFfiError *zonarosa_connection_manager_on_network_change(ZonaRosaConstPointerConnectionManager connection_manager);

ZonaRosaFfiError *zonarosa_connection_manager_set_censorship_circumvention_enabled(ZonaRosaConstPointerConnectionManager connection_manager, bool enabled);

ZonaRosaFfiError *zonarosa_connection_manager_set_invalid_proxy(ZonaRosaConstPointerConnectionManager connection_manager);

ZonaRosaFfiError *zonarosa_connection_manager_set_proxy(ZonaRosaConstPointerConnectionManager connection_manager, ZonaRosaConstPointerConnectionProxyConfig proxy);

ZonaRosaFfiError *zonarosa_connection_manager_set_remote_config(ZonaRosaConstPointerConnectionManager connection_manager, ZonaRosaMutPointerBridgedStringMap remote_config, uint8_t build_variant);

ZonaRosaFfiError *zonarosa_connection_proxy_config_clone(ZonaRosaMutPointerConnectionProxyConfig *new_obj, ZonaRosaConstPointerConnectionProxyConfig obj);

ZonaRosaFfiError *zonarosa_connection_proxy_config_destroy(ZonaRosaMutPointerConnectionProxyConfig p);

ZonaRosaFfiError *zonarosa_connection_proxy_config_new(ZonaRosaMutPointerConnectionProxyConfig *out, const char *scheme, const char *host, int32_t port, const char *username, const char *password);

ZonaRosaFfiError *zonarosa_create_call_link_credential_check_valid_contents(ZonaRosaBorrowedBuffer params_bytes);

ZonaRosaFfiError *zonarosa_create_call_link_credential_present_deterministic(ZonaRosaOwnedBuffer *out, ZonaRosaBorrowedBuffer credential_bytes, ZonaRosaBorrowedBuffer room_id, const ZonaRosaServiceIdFixedWidthBinaryBytes *user_id, ZonaRosaBorrowedBuffer server_params_bytes, ZonaRosaBorrowedBuffer call_link_params_bytes, const uint8_t (*randomness)[ZonaRosaRANDOMNESS_LEN]);

ZonaRosaFfiError *zonarosa_create_call_link_credential_presentation_check_valid_contents(ZonaRosaBorrowedBuffer presentation_bytes);

ZonaRosaFfiError *zonarosa_create_call_link_credential_presentation_verify(ZonaRosaBorrowedBuffer presentation_bytes, ZonaRosaBorrowedBuffer room_id, uint64_t now, ZonaRosaBorrowedBuffer server_params_bytes, ZonaRosaBorrowedBuffer call_link_params_bytes);

ZonaRosaFfiError *zonarosa_create_call_link_credential_request_check_valid_contents(ZonaRosaBorrowedBuffer request_bytes);

ZonaRosaFfiError *zonarosa_create_call_link_credential_request_context_check_valid_contents(ZonaRosaBorrowedBuffer context_bytes);

ZonaRosaFfiError *zonarosa_create_call_link_credential_request_context_get_request(ZonaRosaOwnedBuffer *out, ZonaRosaBorrowedBuffer context_bytes);

ZonaRosaFfiError *zonarosa_create_call_link_credential_request_context_new_deterministic(ZonaRosaOwnedBuffer *out, ZonaRosaBorrowedBuffer room_id, const uint8_t (*randomness)[ZonaRosaRANDOMNESS_LEN]);

ZonaRosaFfiError *zonarosa_create_call_link_credential_request_context_receive_response(ZonaRosaOwnedBuffer *out, ZonaRosaBorrowedBuffer context_bytes, ZonaRosaBorrowedBuffer response_bytes, const ZonaRosaServiceIdFixedWidthBinaryBytes *user_id, ZonaRosaBorrowedBuffer params_bytes);

ZonaRosaFfiError *zonarosa_create_call_link_credential_request_issue_deterministic(ZonaRosaOwnedBuffer *out, ZonaRosaBorrowedBuffer request_bytes, const ZonaRosaServiceIdFixedWidthBinaryBytes *user_id, uint64_t timestamp, ZonaRosaBorrowedBuffer params_bytes, const uint8_t (*randomness)[ZonaRosaRANDOMNESS_LEN]);

ZonaRosaFfiError *zonarosa_create_call_link_credential_response_check_valid_contents(ZonaRosaBorrowedBuffer response_bytes);

ZonaRosaFfiError *zonarosa_decrypt_message(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerZonaRosaMessage message, ZonaRosaConstPointerProtocolAddress protocol_address, ZonaRosaConstPointerFfiSessionStoreStruct session_store, ZonaRosaConstPointerFfiIdentityKeyStoreStruct identity_key_store);

ZonaRosaFfiError *zonarosa_decrypt_pre_key_message(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerPreKeyZonaRosaMessage message, ZonaRosaConstPointerProtocolAddress protocol_address, ZonaRosaConstPointerFfiSessionStoreStruct session_store, ZonaRosaConstPointerFfiIdentityKeyStoreStruct identity_key_store, ZonaRosaConstPointerFfiPreKeyStoreStruct prekey_store, ZonaRosaConstPointerFfiSignedPreKeyStoreStruct signed_prekey_store, ZonaRosaConstPointerFfiKyberPreKeyStoreStruct kyber_prekey_store);

ZonaRosaFfiError *zonarosa_decryption_error_message_clone(ZonaRosaMutPointerDecryptionErrorMessage *new_obj, ZonaRosaConstPointerDecryptionErrorMessage obj);

ZonaRosaFfiError *zonarosa_decryption_error_message_deserialize(ZonaRosaMutPointerDecryptionErrorMessage *out, ZonaRosaBorrowedBuffer data);

ZonaRosaFfiError *zonarosa_decryption_error_message_destroy(ZonaRosaMutPointerDecryptionErrorMessage p);

ZonaRosaFfiError *zonarosa_decryption_error_message_extract_from_serialized_content(ZonaRosaMutPointerDecryptionErrorMessage *out, ZonaRosaBorrowedBuffer bytes);

ZonaRosaFfiError *zonarosa_decryption_error_message_for_original_message(ZonaRosaMutPointerDecryptionErrorMessage *out, ZonaRosaBorrowedBuffer original_bytes, uint8_t original_type, uint64_t original_timestamp, uint32_t original_sender_device_id);

ZonaRosaFfiError *zonarosa_decryption_error_message_get_device_id(uint32_t *out, ZonaRosaConstPointerDecryptionErrorMessage obj);

ZonaRosaFfiError *zonarosa_decryption_error_message_get_ratchet_key(ZonaRosaMutPointerPublicKey *out, ZonaRosaConstPointerDecryptionErrorMessage m);

ZonaRosaFfiError *zonarosa_decryption_error_message_get_timestamp(uint64_t *out, ZonaRosaConstPointerDecryptionErrorMessage obj);

ZonaRosaFfiError *zonarosa_decryption_error_message_serialize(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerDecryptionErrorMessage obj);

ZonaRosaFfiError *zonarosa_device_transfer_generate_certificate(ZonaRosaOwnedBuffer *out, ZonaRosaBorrowedBuffer private_key, const char *name, uint32_t days_to_expire);

ZonaRosaFfiError *zonarosa_device_transfer_generate_private_key(ZonaRosaOwnedBuffer *out);

ZonaRosaFfiError *zonarosa_device_transfer_generate_private_key_with_format(ZonaRosaOwnedBuffer *out, uint8_t key_format);

ZonaRosaFfiError *zonarosa_encrypt_message(ZonaRosaMutPointerCiphertextMessage *out, ZonaRosaBorrowedBuffer ptext, ZonaRosaConstPointerProtocolAddress protocol_address, ZonaRosaConstPointerFfiSessionStoreStruct session_store, ZonaRosaConstPointerFfiIdentityKeyStoreStruct identity_key_store, uint64_t now);

void zonarosa_error_free(ZonaRosaFfiError *err);

ZonaRosaFfiError *zonarosa_error_get_address(ZonaRosaMutPointerProtocolAddress *out, ZonaRosaUnwindSafeArgZonaRosaFfiError err);

ZonaRosaFfiError *zonarosa_error_get_invalid_protocol_address(ZonaRosaPairOfc_charu32 *out, ZonaRosaUnwindSafeArgZonaRosaFfiError err);

ZonaRosaFfiError *zonarosa_error_get_message(const char **out, ZonaRosaUnwindSafeArgZonaRosaFfiError err);

ZonaRosaFfiError *zonarosa_error_get_mismatched_device_errors(ZonaRosaOwnedBufferOfFfiMismatchedDevicesError *out, ZonaRosaUnwindSafeArgZonaRosaFfiError err);

ZonaRosaFfiError *zonarosa_error_get_our_fingerprint_version(uint32_t *out, ZonaRosaUnwindSafeArgZonaRosaFfiError err);

ZonaRosaFfiError *zonarosa_error_get_rate_limit_challenge(ZonaRosaPairOfc_charOwnedBufferOfc_uchar *out, ZonaRosaUnwindSafeArgZonaRosaFfiError err);

ZonaRosaFfiError *zonarosa_error_get_registration_error_not_deliverable(ZonaRosaPairOfc_charbool *out, ZonaRosaUnwindSafeArgZonaRosaFfiError err);

ZonaRosaFfiError *zonarosa_error_get_registration_lock(uint64_t *out_time_remaining_seconds, const char **out_svr2_username, const char **out_svr2_password, const ZonaRosaFfiError *err);

ZonaRosaFfiError *zonarosa_error_get_retry_after_seconds(uint32_t *out, ZonaRosaUnwindSafeArgZonaRosaFfiError err);

ZonaRosaFfiError *zonarosa_error_get_their_fingerprint_version(uint32_t *out, ZonaRosaUnwindSafeArgZonaRosaFfiError err);

ZonaRosaFfiError *zonarosa_error_get_tries_remaining(uint32_t *out, ZonaRosaUnwindSafeArgZonaRosaFfiError err);

uint32_t zonarosa_error_get_type(const ZonaRosaFfiError *err);

ZonaRosaFfiError *zonarosa_error_get_unknown_fields(ZonaRosaStringArray *out, ZonaRosaUnwindSafeArgZonaRosaFfiError err);

ZonaRosaFfiError *zonarosa_error_get_uuid(ZonaRosaUuid *out, ZonaRosaUnwindSafeArgZonaRosaFfiError err);

ZonaRosaFfiError *zonarosa_expiring_profile_key_credential_check_valid_contents(ZonaRosaBorrowedBuffer buffer);

ZonaRosaFfiError *zonarosa_expiring_profile_key_credential_get_expiration_time(uint64_t *out, const unsigned char (*credential)[ZonaRosaEXPIRING_PROFILE_KEY_CREDENTIAL_LEN]);

ZonaRosaFfiError *zonarosa_expiring_profile_key_credential_response_check_valid_contents(ZonaRosaBorrowedBuffer buffer);

ZonaRosaFfiError *zonarosa_fingerprint_clone(ZonaRosaMutPointerFingerprint *new_obj, ZonaRosaConstPointerFingerprint obj);

ZonaRosaFfiError *zonarosa_fingerprint_compare(bool *out, ZonaRosaBorrowedBuffer fprint1, ZonaRosaBorrowedBuffer fprint2);

ZonaRosaFfiError *zonarosa_fingerprint_destroy(ZonaRosaMutPointerFingerprint p);

ZonaRosaFfiError *zonarosa_fingerprint_display_string(const char **out, ZonaRosaConstPointerFingerprint obj);

ZonaRosaFfiError *zonarosa_fingerprint_new(ZonaRosaMutPointerFingerprint *out, uint32_t iterations, uint32_t version, ZonaRosaBorrowedBuffer local_identifier, ZonaRosaConstPointerPublicKey local_key, ZonaRosaBorrowedBuffer remote_identifier, ZonaRosaConstPointerPublicKey remote_key);

ZonaRosaFfiError *zonarosa_fingerprint_scannable_encoding(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerFingerprint obj);

void zonarosa_free_buffer(const unsigned char *buf, size_t buf_len);

void zonarosa_free_bytestring_array(ZonaRosaBytestringArray array);

void zonarosa_free_list_of_mismatched_device_errors(ZonaRosaOwnedBufferOfFfiMismatchedDevicesError buffer);

void zonarosa_free_list_of_register_response_badges(ZonaRosaOwnedBufferOfFfiRegisterResponseBadge buffer);

void zonarosa_free_list_of_service_ids(ZonaRosaOwnedBufferOfServiceIdFixedWidthBinaryBytes buffer);

void zonarosa_free_list_of_strings(ZonaRosaOwnedBufferOfCStringPtr buffer);

void zonarosa_free_lookup_response_entry_list(ZonaRosaOwnedBufferOfFfiCdsiLookupResponseEntry buffer);

void zonarosa_free_string(const char *buf);

ZonaRosaFfiError *zonarosa_generic_server_public_params_check_valid_contents(ZonaRosaBorrowedBuffer params_bytes);

ZonaRosaFfiError *zonarosa_generic_server_secret_params_check_valid_contents(ZonaRosaBorrowedBuffer params_bytes);

ZonaRosaFfiError *zonarosa_generic_server_secret_params_generate_deterministic(ZonaRosaOwnedBuffer *out, const uint8_t (*randomness)[ZonaRosaRANDOMNESS_LEN]);

ZonaRosaFfiError *zonarosa_generic_server_secret_params_get_public_params(ZonaRosaOwnedBuffer *out, ZonaRosaBorrowedBuffer params_bytes);

ZonaRosaFfiError *zonarosa_group_decrypt_message(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerProtocolAddress sender, ZonaRosaBorrowedBuffer message, ZonaRosaConstPointerFfiSenderKeyStoreStruct store);

ZonaRosaFfiError *zonarosa_group_encrypt_message(ZonaRosaMutPointerCiphertextMessage *out, ZonaRosaConstPointerProtocolAddress sender, ZonaRosaUuid distribution_id, ZonaRosaBorrowedBuffer message, ZonaRosaConstPointerFfiSenderKeyStoreStruct store);

ZonaRosaFfiError *zonarosa_group_master_key_check_valid_contents(ZonaRosaBorrowedBuffer buffer);

ZonaRosaFfiError *zonarosa_group_public_params_check_valid_contents(ZonaRosaBorrowedBuffer buffer);

ZonaRosaFfiError *zonarosa_group_public_params_get_group_identifier(uint8_t (*out)[ZonaRosaGROUP_IDENTIFIER_LEN], const unsigned char (*group_public_params)[ZonaRosaGROUP_PUBLIC_PARAMS_LEN]);

ZonaRosaFfiError *zonarosa_group_secret_params_check_valid_contents(ZonaRosaBorrowedBuffer buffer);

ZonaRosaFfiError *zonarosa_group_secret_params_decrypt_blob_with_padding(ZonaRosaOwnedBuffer *out, const unsigned char (*params)[ZonaRosaGROUP_SECRET_PARAMS_LEN], ZonaRosaBorrowedBuffer ciphertext);

ZonaRosaFfiError *zonarosa_group_secret_params_decrypt_profile_key(unsigned char (*out)[ZonaRosaPROFILE_KEY_LEN], const unsigned char (*params)[ZonaRosaGROUP_SECRET_PARAMS_LEN], const unsigned char (*profile_key)[ZonaRosaPROFILE_KEY_CIPHERTEXT_LEN], const ZonaRosaServiceIdFixedWidthBinaryBytes *user_id);

ZonaRosaFfiError *zonarosa_group_secret_params_decrypt_service_id(ZonaRosaServiceIdFixedWidthBinaryBytes *out, const unsigned char (*params)[ZonaRosaGROUP_SECRET_PARAMS_LEN], const unsigned char (*ciphertext)[ZonaRosaUUID_CIPHERTEXT_LEN]);

ZonaRosaFfiError *zonarosa_group_secret_params_derive_from_master_key(unsigned char (*out)[ZonaRosaGROUP_SECRET_PARAMS_LEN], const unsigned char (*master_key)[ZonaRosaGROUP_MASTER_KEY_LEN]);

ZonaRosaFfiError *zonarosa_group_secret_params_encrypt_blob_with_padding_deterministic(ZonaRosaOwnedBuffer *out, const unsigned char (*params)[ZonaRosaGROUP_SECRET_PARAMS_LEN], const uint8_t (*randomness)[ZonaRosaRANDOMNESS_LEN], ZonaRosaBorrowedBuffer plaintext, uint32_t padding_len);

ZonaRosaFfiError *zonarosa_group_secret_params_encrypt_profile_key(unsigned char (*out)[ZonaRosaPROFILE_KEY_CIPHERTEXT_LEN], const unsigned char (*params)[ZonaRosaGROUP_SECRET_PARAMS_LEN], const unsigned char (*profile_key)[ZonaRosaPROFILE_KEY_LEN], const ZonaRosaServiceIdFixedWidthBinaryBytes *user_id);

ZonaRosaFfiError *zonarosa_group_secret_params_encrypt_service_id(unsigned char (*out)[ZonaRosaUUID_CIPHERTEXT_LEN], const unsigned char (*params)[ZonaRosaGROUP_SECRET_PARAMS_LEN], const ZonaRosaServiceIdFixedWidthBinaryBytes *service_id);

ZonaRosaFfiError *zonarosa_group_secret_params_generate_deterministic(unsigned char (*out)[ZonaRosaGROUP_SECRET_PARAMS_LEN], const uint8_t (*randomness)[ZonaRosaRANDOMNESS_LEN]);

ZonaRosaFfiError *zonarosa_group_secret_params_get_master_key(unsigned char (*out)[ZonaRosaGROUP_MASTER_KEY_LEN], const unsigned char (*params)[ZonaRosaGROUP_SECRET_PARAMS_LEN]);

ZonaRosaFfiError *zonarosa_group_secret_params_get_public_params(unsigned char (*out)[ZonaRosaGROUP_PUBLIC_PARAMS_LEN], const unsigned char (*params)[ZonaRosaGROUP_SECRET_PARAMS_LEN]);

ZonaRosaFfiError *zonarosa_group_send_derived_key_pair_check_valid_contents(ZonaRosaBorrowedBuffer bytes);

ZonaRosaFfiError *zonarosa_group_send_derived_key_pair_for_expiration(ZonaRosaOwnedBuffer *out, uint64_t expiration, ZonaRosaConstPointerServerSecretParams server_params);

ZonaRosaFfiError *zonarosa_group_send_endorsement_call_link_params_to_token(ZonaRosaOwnedBuffer *out, ZonaRosaBorrowedBuffer endorsement, ZonaRosaBorrowedBuffer call_link_secret_params_serialized);

ZonaRosaFfiError *zonarosa_group_send_endorsement_check_valid_contents(ZonaRosaBorrowedBuffer bytes);

ZonaRosaFfiError *zonarosa_group_send_endorsement_combine(ZonaRosaOwnedBuffer *out, ZonaRosaBorrowedSliceOfBuffers endorsements);

ZonaRosaFfiError *zonarosa_group_send_endorsement_remove(ZonaRosaOwnedBuffer *out, ZonaRosaBorrowedBuffer endorsement, ZonaRosaBorrowedBuffer to_remove);

ZonaRosaFfiError *zonarosa_group_send_endorsement_to_token(ZonaRosaOwnedBuffer *out, ZonaRosaBorrowedBuffer endorsement, const unsigned char (*group_params)[ZonaRosaGROUP_SECRET_PARAMS_LEN]);

ZonaRosaFfiError *zonarosa_group_send_endorsements_response_check_valid_contents(ZonaRosaBorrowedBuffer bytes);

ZonaRosaFfiError *zonarosa_group_send_endorsements_response_get_expiration(uint64_t *out, ZonaRosaBorrowedBuffer response_bytes);

ZonaRosaFfiError *zonarosa_group_send_endorsements_response_issue_deterministic(ZonaRosaOwnedBuffer *out, ZonaRosaBorrowedBuffer concatenated_group_member_ciphertexts, ZonaRosaBorrowedBuffer key_pair, const uint8_t (*randomness)[ZonaRosaRANDOMNESS_LEN]);

ZonaRosaFfiError *zonarosa_group_send_endorsements_response_receive_and_combine_with_ciphertexts(ZonaRosaBytestringArray *out, ZonaRosaBorrowedBuffer response_bytes, ZonaRosaBorrowedBuffer concatenated_group_member_ciphertexts, ZonaRosaBorrowedBuffer local_user_ciphertext, uint64_t now, ZonaRosaConstPointerServerPublicParams server_params);

ZonaRosaFfiError *zonarosa_group_send_endorsements_response_receive_and_combine_with_service_ids(ZonaRosaBytestringArray *out, ZonaRosaBorrowedBuffer response_bytes, ZonaRosaBorrowedBuffer group_members, const ZonaRosaServiceIdFixedWidthBinaryBytes *local_user, uint64_t now, const unsigned char (*group_params)[ZonaRosaGROUP_SECRET_PARAMS_LEN], ZonaRosaConstPointerServerPublicParams server_params);

ZonaRosaFfiError *zonarosa_group_send_full_token_check_valid_contents(ZonaRosaBorrowedBuffer bytes);

ZonaRosaFfiError *zonarosa_group_send_full_token_get_expiration(uint64_t *out, ZonaRosaBorrowedBuffer token);

ZonaRosaFfiError *zonarosa_group_send_full_token_verify(ZonaRosaBorrowedBuffer token, ZonaRosaBorrowedBuffer user_ids, uint64_t now, ZonaRosaBorrowedBuffer key_pair);

ZonaRosaFfiError *zonarosa_group_send_token_check_valid_contents(ZonaRosaBorrowedBuffer bytes);

ZonaRosaFfiError *zonarosa_group_send_token_to_full_token(ZonaRosaOwnedBuffer *out, ZonaRosaBorrowedBuffer token, uint64_t expiration);

ZonaRosaFfiError *zonarosa_hex_encode(ZonaRosaBorrowedMutableBuffer output, ZonaRosaBorrowedBuffer input);

ZonaRosaFfiError *zonarosa_hkdf_derive(ZonaRosaBorrowedMutableBuffer output, ZonaRosaBorrowedBuffer ikm, ZonaRosaBorrowedBuffer label, ZonaRosaBorrowedBuffer salt);

ZonaRosaFfiError *zonarosa_hsm_enclave_client_complete_handshake(ZonaRosaMutPointerHsmEnclaveClient cli, ZonaRosaBorrowedBuffer handshake_received);

ZonaRosaFfiError *zonarosa_hsm_enclave_client_destroy(ZonaRosaMutPointerHsmEnclaveClient p);

ZonaRosaFfiError *zonarosa_hsm_enclave_client_established_recv(ZonaRosaOwnedBuffer *out, ZonaRosaMutPointerHsmEnclaveClient cli, ZonaRosaBorrowedBuffer received_ciphertext);

ZonaRosaFfiError *zonarosa_hsm_enclave_client_established_send(ZonaRosaOwnedBuffer *out, ZonaRosaMutPointerHsmEnclaveClient cli, ZonaRosaBorrowedBuffer plaintext_to_send);

ZonaRosaFfiError *zonarosa_hsm_enclave_client_initial_request(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerHsmEnclaveClient obj);

ZonaRosaFfiError *zonarosa_hsm_enclave_client_new(ZonaRosaMutPointerHsmEnclaveClient *out, ZonaRosaBorrowedBuffer trusted_public_key, ZonaRosaBorrowedBuffer trusted_code_hashes);

ZonaRosaFfiError *zonarosa_http_request_add_header(ZonaRosaConstPointerHttpRequest request, const char *name, const char *value);

ZonaRosaFfiError *zonarosa_http_request_destroy(ZonaRosaMutPointerHttpRequest p);

ZonaRosaFfiError *zonarosa_http_request_new_with_body(ZonaRosaMutPointerHttpRequest *out, const char *method, const char *path, ZonaRosaBorrowedBuffer body_as_slice);

ZonaRosaFfiError *zonarosa_http_request_new_without_body(ZonaRosaMutPointerHttpRequest *out, const char *method, const char *path);

ZonaRosaFfiError *zonarosa_identitykey_verify_alternate_identity(bool *out, ZonaRosaConstPointerPublicKey public_key, ZonaRosaConstPointerPublicKey other_identity, ZonaRosaBorrowedBuffer signature);

ZonaRosaFfiError *zonarosa_identitykeypair_deserialize(ZonaRosaPairOfMutPointerPublicKeyMutPointerPrivateKey *out, ZonaRosaBorrowedBuffer input);

ZonaRosaFfiError *zonarosa_identitykeypair_serialize(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerPublicKey public_key, ZonaRosaConstPointerPrivateKey private_key);

ZonaRosaFfiError *zonarosa_identitykeypair_sign_alternate_identity(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerPublicKey public_key, ZonaRosaConstPointerPrivateKey private_key, ZonaRosaConstPointerPublicKey other_identity);

ZonaRosaFfiError *zonarosa_incremental_mac_calculate_chunk_size(uint32_t *out, uint32_t data_size);

ZonaRosaFfiError *zonarosa_incremental_mac_destroy(ZonaRosaMutPointerIncrementalMac p);

ZonaRosaFfiError *zonarosa_incremental_mac_finalize(ZonaRosaOwnedBuffer *out, ZonaRosaMutPointerIncrementalMac mac);

ZonaRosaFfiError *zonarosa_incremental_mac_initialize(ZonaRosaMutPointerIncrementalMac *out, ZonaRosaBorrowedBuffer key, uint32_t chunk_size);

ZonaRosaFfiError *zonarosa_incremental_mac_update(ZonaRosaOwnedBuffer *out, ZonaRosaMutPointerIncrementalMac mac, ZonaRosaBorrowedBuffer bytes, uint32_t offset, uint32_t length);

bool zonarosa_init_logger(ZonaRosaLogLevel max_level, ZonaRosaFfiLogger logger);

ZonaRosaFfiError *zonarosa_key_transparency_aci_search_key(ZonaRosaOwnedBuffer *out, const ZonaRosaServiceIdFixedWidthBinaryBytes *aci);

ZonaRosaFfiError *zonarosa_key_transparency_distinguished(ZonaRosaCPromiseOwnedBufferOfc_uchar *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, uint8_t environment, ZonaRosaConstPointerUnauthenticatedChatConnection chat_connection, ZonaRosaOptionalBorrowedSliceOfc_uchar last_distinguished_tree_head);

ZonaRosaFfiError *zonarosa_key_transparency_e164_search_key(ZonaRosaOwnedBuffer *out, const char *e164);

ZonaRosaFfiError *zonarosa_key_transparency_monitor(ZonaRosaCPromiseOwnedBufferOfc_uchar *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, uint8_t environment, ZonaRosaConstPointerUnauthenticatedChatConnection chat_connection, const ZonaRosaServiceIdFixedWidthBinaryBytes *aci, ZonaRosaConstPointerPublicKey aci_identity_key, const char *e164, ZonaRosaOptionalBorrowedSliceOfc_uchar unidentified_access_key, ZonaRosaOptionalBorrowedSliceOfc_uchar username_hash, ZonaRosaOptionalBorrowedSliceOfc_uchar account_data, ZonaRosaBorrowedBuffer last_distinguished_tree_head, bool is_self_monitor);

ZonaRosaFfiError *zonarosa_key_transparency_search(ZonaRosaCPromiseOwnedBufferOfc_uchar *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, uint8_t environment, ZonaRosaConstPointerUnauthenticatedChatConnection chat_connection, const ZonaRosaServiceIdFixedWidthBinaryBytes *aci, ZonaRosaConstPointerPublicKey aci_identity_key, const char *e164, ZonaRosaOptionalBorrowedSliceOfc_uchar unidentified_access_key, ZonaRosaOptionalBorrowedSliceOfc_uchar username_hash, ZonaRosaOptionalBorrowedSliceOfc_uchar account_data, ZonaRosaBorrowedBuffer last_distinguished_tree_head);

ZonaRosaFfiError *zonarosa_key_transparency_username_hash_search_key(ZonaRosaOwnedBuffer *out, ZonaRosaBorrowedBuffer hash);

ZonaRosaFfiError *zonarosa_kyber_key_pair_clone(ZonaRosaMutPointerKyberKeyPair *new_obj, ZonaRosaConstPointerKyberKeyPair obj);

ZonaRosaFfiError *zonarosa_kyber_key_pair_destroy(ZonaRosaMutPointerKyberKeyPair p);

ZonaRosaFfiError *zonarosa_kyber_key_pair_generate(ZonaRosaMutPointerKyberKeyPair *out);

ZonaRosaFfiError *zonarosa_kyber_key_pair_get_public_key(ZonaRosaMutPointerKyberPublicKey *out, ZonaRosaConstPointerKyberKeyPair key_pair);

ZonaRosaFfiError *zonarosa_kyber_key_pair_get_secret_key(ZonaRosaMutPointerKyberSecretKey *out, ZonaRosaConstPointerKyberKeyPair key_pair);

ZonaRosaFfiError *zonarosa_kyber_pre_key_record_clone(ZonaRosaMutPointerKyberPreKeyRecord *new_obj, ZonaRosaConstPointerKyberPreKeyRecord obj);

ZonaRosaFfiError *zonarosa_kyber_pre_key_record_deserialize(ZonaRosaMutPointerKyberPreKeyRecord *out, ZonaRosaBorrowedBuffer data);

ZonaRosaFfiError *zonarosa_kyber_pre_key_record_destroy(ZonaRosaMutPointerKyberPreKeyRecord p);

ZonaRosaFfiError *zonarosa_kyber_pre_key_record_get_id(uint32_t *out, ZonaRosaConstPointerKyberPreKeyRecord obj);

ZonaRosaFfiError *zonarosa_kyber_pre_key_record_get_key_pair(ZonaRosaMutPointerKyberKeyPair *out, ZonaRosaConstPointerKyberPreKeyRecord obj);

ZonaRosaFfiError *zonarosa_kyber_pre_key_record_get_public_key(ZonaRosaMutPointerKyberPublicKey *out, ZonaRosaConstPointerKyberPreKeyRecord obj);

ZonaRosaFfiError *zonarosa_kyber_pre_key_record_get_secret_key(ZonaRosaMutPointerKyberSecretKey *out, ZonaRosaConstPointerKyberPreKeyRecord obj);

ZonaRosaFfiError *zonarosa_kyber_pre_key_record_get_signature(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerKyberPreKeyRecord obj);

ZonaRosaFfiError *zonarosa_kyber_pre_key_record_get_timestamp(uint64_t *out, ZonaRosaConstPointerKyberPreKeyRecord obj);

ZonaRosaFfiError *zonarosa_kyber_pre_key_record_new(ZonaRosaMutPointerKyberPreKeyRecord *out, uint32_t id, uint64_t timestamp, ZonaRosaConstPointerKyberKeyPair key_pair, ZonaRosaBorrowedBuffer signature);

ZonaRosaFfiError *zonarosa_kyber_pre_key_record_serialize(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerKyberPreKeyRecord obj);

ZonaRosaFfiError *zonarosa_kyber_public_key_clone(ZonaRosaMutPointerKyberPublicKey *new_obj, ZonaRosaConstPointerKyberPublicKey obj);

ZonaRosaFfiError *zonarosa_kyber_public_key_deserialize(ZonaRosaMutPointerKyberPublicKey *out, ZonaRosaBorrowedBuffer data);

ZonaRosaFfiError *zonarosa_kyber_public_key_destroy(ZonaRosaMutPointerKyberPublicKey p);

ZonaRosaFfiError *zonarosa_kyber_public_key_equals(bool *out, ZonaRosaConstPointerKyberPublicKey lhs, ZonaRosaConstPointerKyberPublicKey rhs);

ZonaRosaFfiError *zonarosa_kyber_public_key_serialize(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerKyberPublicKey obj);

ZonaRosaFfiError *zonarosa_kyber_secret_key_clone(ZonaRosaMutPointerKyberSecretKey *new_obj, ZonaRosaConstPointerKyberSecretKey obj);

ZonaRosaFfiError *zonarosa_kyber_secret_key_deserialize(ZonaRosaMutPointerKyberSecretKey *out, ZonaRosaBorrowedBuffer data);

ZonaRosaFfiError *zonarosa_kyber_secret_key_destroy(ZonaRosaMutPointerKyberSecretKey p);

ZonaRosaFfiError *zonarosa_kyber_secret_key_serialize(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerKyberSecretKey obj);

ZonaRosaFfiError *zonarosa_lookup_request_add_aci_and_access_key(ZonaRosaConstPointerLookupRequest request, const ZonaRosaServiceIdFixedWidthBinaryBytes *aci, ZonaRosaBorrowedBuffer access_key);

ZonaRosaFfiError *zonarosa_lookup_request_add_e164(ZonaRosaConstPointerLookupRequest request, const char *e164);

ZonaRosaFfiError *zonarosa_lookup_request_add_previous_e164(ZonaRosaConstPointerLookupRequest request, const char *e164);

ZonaRosaFfiError *zonarosa_lookup_request_destroy(ZonaRosaMutPointerLookupRequest p);

ZonaRosaFfiError *zonarosa_lookup_request_new(ZonaRosaMutPointerLookupRequest *out);

ZonaRosaFfiError *zonarosa_lookup_request_set_token(ZonaRosaConstPointerLookupRequest request, ZonaRosaBorrowedBuffer token);

ZonaRosaFfiError *zonarosa_message_backup_key_destroy(ZonaRosaMutPointerMessageBackupKey p);

ZonaRosaFfiError *zonarosa_message_backup_key_from_account_entropy_pool(ZonaRosaMutPointerMessageBackupKey *out, const char *account_entropy, const ZonaRosaServiceIdFixedWidthBinaryBytes *aci, const uint8_t (*forward_secrecy_token)[ZonaRosaBACKUP_FORWARD_SECRECY_TOKEN_LEN]);

ZonaRosaFfiError *zonarosa_message_backup_key_from_backup_key_and_backup_id(ZonaRosaMutPointerMessageBackupKey *out, const uint8_t (*backup_key)[32], const uint8_t (*backup_id)[16], const uint8_t (*forward_secrecy_token)[ZonaRosaBACKUP_FORWARD_SECRECY_TOKEN_LEN]);

ZonaRosaFfiError *zonarosa_message_backup_key_get_aes_key(uint8_t (*out)[32], ZonaRosaConstPointerMessageBackupKey key);

ZonaRosaFfiError *zonarosa_message_backup_key_get_hmac_key(uint8_t (*out)[32], ZonaRosaConstPointerMessageBackupKey key);

ZonaRosaFfiError *zonarosa_message_backup_validation_outcome_destroy(ZonaRosaMutPointerMessageBackupValidationOutcome p);

ZonaRosaFfiError *zonarosa_message_backup_validation_outcome_get_error_message(const char **out, ZonaRosaConstPointerMessageBackupValidationOutcome outcome);

ZonaRosaFfiError *zonarosa_message_backup_validation_outcome_get_unknown_fields(ZonaRosaStringArray *out, ZonaRosaConstPointerMessageBackupValidationOutcome outcome);

ZonaRosaFfiError *zonarosa_message_backup_validator_validate(ZonaRosaMutPointerMessageBackupValidationOutcome *out, ZonaRosaConstPointerMessageBackupKey key, ZonaRosaConstPointerFfiInputStreamStruct first_stream, ZonaRosaConstPointerFfiInputStreamStruct second_stream, uint64_t len, uint8_t purpose);

ZonaRosaFfiError *zonarosa_message_clone(ZonaRosaMutPointerZonaRosaMessage *new_obj, ZonaRosaConstPointerZonaRosaMessage obj);

ZonaRosaFfiError *zonarosa_message_deserialize(ZonaRosaMutPointerZonaRosaMessage *out, ZonaRosaBorrowedBuffer data);

ZonaRosaFfiError *zonarosa_message_destroy(ZonaRosaMutPointerZonaRosaMessage p);

ZonaRosaFfiError *zonarosa_message_get_body(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerZonaRosaMessage obj);

ZonaRosaFfiError *zonarosa_message_get_counter(uint32_t *out, ZonaRosaConstPointerZonaRosaMessage obj);

ZonaRosaFfiError *zonarosa_message_get_message_version(uint32_t *out, ZonaRosaConstPointerZonaRosaMessage obj);

ZonaRosaFfiError *zonarosa_message_get_pq_ratchet(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerZonaRosaMessage msg);

ZonaRosaFfiError *zonarosa_message_get_sender_ratchet_key(ZonaRosaMutPointerPublicKey *out, ZonaRosaConstPointerZonaRosaMessage m);

ZonaRosaFfiError *zonarosa_message_get_serialized(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerZonaRosaMessage obj);

ZonaRosaFfiError *zonarosa_message_new(ZonaRosaMutPointerZonaRosaMessage *out, uint8_t message_version, ZonaRosaBorrowedBuffer mac_key, ZonaRosaConstPointerPublicKey sender_ratchet_key, uint32_t counter, uint32_t previous_counter, ZonaRosaBorrowedBuffer ciphertext, ZonaRosaConstPointerPublicKey sender_identity_key, ZonaRosaConstPointerPublicKey receiver_identity_key, ZonaRosaBorrowedBuffer pq_ratchet);

ZonaRosaFfiError *zonarosa_message_verify_mac(bool *out, ZonaRosaConstPointerZonaRosaMessage msg, ZonaRosaConstPointerPublicKey sender_identity_key, ZonaRosaConstPointerPublicKey receiver_identity_key, ZonaRosaBorrowedBuffer mac_key);

ZonaRosaFfiError *zonarosa_mp4_sanitizer_sanitize(ZonaRosaMutPointerSanitizedMetadata *out, ZonaRosaConstPointerFfiInputStreamStruct input, uint64_t len);

ZonaRosaFfiError *zonarosa_online_backup_validator_add_frame(ZonaRosaMutPointerOnlineBackupValidator backup, ZonaRosaBorrowedBuffer frame);

ZonaRosaFfiError *zonarosa_online_backup_validator_destroy(ZonaRosaMutPointerOnlineBackupValidator p);

ZonaRosaFfiError *zonarosa_online_backup_validator_finalize(ZonaRosaMutPointerOnlineBackupValidator backup);

ZonaRosaFfiError *zonarosa_online_backup_validator_new(ZonaRosaMutPointerOnlineBackupValidator *out, ZonaRosaBorrowedBuffer backup_info_frame, uint8_t purpose);

ZonaRosaFfiError *zonarosa_pin_hash_access_key(uint8_t (*out)[32], ZonaRosaConstPointerPinHash ph);

ZonaRosaFfiError *zonarosa_pin_hash_clone(ZonaRosaMutPointerPinHash *new_obj, ZonaRosaConstPointerPinHash obj);

ZonaRosaFfiError *zonarosa_pin_hash_destroy(ZonaRosaMutPointerPinHash p);

ZonaRosaFfiError *zonarosa_pin_hash_encryption_key(uint8_t (*out)[32], ZonaRosaConstPointerPinHash ph);

ZonaRosaFfiError *zonarosa_pin_hash_from_salt(ZonaRosaMutPointerPinHash *out, ZonaRosaBorrowedBuffer pin, const uint8_t (*salt)[32]);

ZonaRosaFfiError *zonarosa_pin_hash_from_username_mrenclave(ZonaRosaMutPointerPinHash *out, ZonaRosaBorrowedBuffer pin, const char *username, ZonaRosaBorrowedBuffer mrenclave);

ZonaRosaFfiError *zonarosa_pin_local_hash(const char **out, ZonaRosaBorrowedBuffer pin);

ZonaRosaFfiError *zonarosa_pin_verify_local_hash(bool *out, const char *encoded_hash, ZonaRosaBorrowedBuffer pin);

ZonaRosaFfiError *zonarosa_plaintext_content_clone(ZonaRosaMutPointerPlaintextContent *new_obj, ZonaRosaConstPointerPlaintextContent obj);

ZonaRosaFfiError *zonarosa_plaintext_content_deserialize(ZonaRosaMutPointerPlaintextContent *out, ZonaRosaBorrowedBuffer data);

ZonaRosaFfiError *zonarosa_plaintext_content_destroy(ZonaRosaMutPointerPlaintextContent p);

ZonaRosaFfiError *zonarosa_plaintext_content_from_decryption_error_message(ZonaRosaMutPointerPlaintextContent *out, ZonaRosaConstPointerDecryptionErrorMessage m);

ZonaRosaFfiError *zonarosa_plaintext_content_get_body(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerPlaintextContent obj);

ZonaRosaFfiError *zonarosa_plaintext_content_serialize(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerPlaintextContent obj);

ZonaRosaFfiError *zonarosa_pre_key_bundle_clone(ZonaRosaMutPointerPreKeyBundle *new_obj, ZonaRosaConstPointerPreKeyBundle obj);

ZonaRosaFfiError *zonarosa_pre_key_bundle_destroy(ZonaRosaMutPointerPreKeyBundle p);

ZonaRosaFfiError *zonarosa_pre_key_bundle_get_device_id(uint32_t *out, ZonaRosaConstPointerPreKeyBundle obj);

ZonaRosaFfiError *zonarosa_pre_key_bundle_get_identity_key(ZonaRosaMutPointerPublicKey *out, ZonaRosaConstPointerPreKeyBundle p);

ZonaRosaFfiError *zonarosa_pre_key_bundle_get_kyber_pre_key_id(uint32_t *out, ZonaRosaConstPointerPreKeyBundle obj);

ZonaRosaFfiError *zonarosa_pre_key_bundle_get_kyber_pre_key_public(ZonaRosaMutPointerKyberPublicKey *out, ZonaRosaConstPointerPreKeyBundle bundle);

ZonaRosaFfiError *zonarosa_pre_key_bundle_get_kyber_pre_key_signature(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerPreKeyBundle obj);

ZonaRosaFfiError *zonarosa_pre_key_bundle_get_pre_key_id(uint32_t *out, ZonaRosaConstPointerPreKeyBundle obj);

ZonaRosaFfiError *zonarosa_pre_key_bundle_get_pre_key_public(ZonaRosaMutPointerPublicKey *out, ZonaRosaConstPointerPreKeyBundle obj);

ZonaRosaFfiError *zonarosa_pre_key_bundle_get_registration_id(uint32_t *out, ZonaRosaConstPointerPreKeyBundle obj);

ZonaRosaFfiError *zonarosa_pre_key_bundle_get_signed_pre_key_id(uint32_t *out, ZonaRosaConstPointerPreKeyBundle obj);

ZonaRosaFfiError *zonarosa_pre_key_bundle_get_signed_pre_key_public(ZonaRosaMutPointerPublicKey *out, ZonaRosaConstPointerPreKeyBundle obj);

ZonaRosaFfiError *zonarosa_pre_key_bundle_get_signed_pre_key_signature(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerPreKeyBundle obj);

ZonaRosaFfiError *zonarosa_pre_key_bundle_new(ZonaRosaMutPointerPreKeyBundle *out, uint32_t registration_id, uint32_t device_id, uint32_t prekey_id, ZonaRosaConstPointerPublicKey prekey, uint32_t signed_prekey_id, ZonaRosaConstPointerPublicKey signed_prekey, ZonaRosaBorrowedBuffer signed_prekey_signature, ZonaRosaConstPointerPublicKey identity_key, uint32_t kyber_prekey_id, ZonaRosaConstPointerKyberPublicKey kyber_prekey, ZonaRosaBorrowedBuffer kyber_prekey_signature);

ZonaRosaFfiError *zonarosa_pre_key_record_clone(ZonaRosaMutPointerPreKeyRecord *new_obj, ZonaRosaConstPointerPreKeyRecord obj);

ZonaRosaFfiError *zonarosa_pre_key_record_deserialize(ZonaRosaMutPointerPreKeyRecord *out, ZonaRosaBorrowedBuffer data);

ZonaRosaFfiError *zonarosa_pre_key_record_destroy(ZonaRosaMutPointerPreKeyRecord p);

ZonaRosaFfiError *zonarosa_pre_key_record_get_id(uint32_t *out, ZonaRosaConstPointerPreKeyRecord obj);

ZonaRosaFfiError *zonarosa_pre_key_record_get_private_key(ZonaRosaMutPointerPrivateKey *out, ZonaRosaConstPointerPreKeyRecord obj);

ZonaRosaFfiError *zonarosa_pre_key_record_get_public_key(ZonaRosaMutPointerPublicKey *out, ZonaRosaConstPointerPreKeyRecord obj);

ZonaRosaFfiError *zonarosa_pre_key_record_new(ZonaRosaMutPointerPreKeyRecord *out, uint32_t id, ZonaRosaConstPointerPublicKey pub_key, ZonaRosaConstPointerPrivateKey priv_key);

ZonaRosaFfiError *zonarosa_pre_key_record_serialize(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerPreKeyRecord obj);

ZonaRosaFfiError *zonarosa_pre_key_zonarosa_message_clone(ZonaRosaMutPointerPreKeyZonaRosaMessage *new_obj, ZonaRosaConstPointerPreKeyZonaRosaMessage obj);

ZonaRosaFfiError *zonarosa_pre_key_zonarosa_message_deserialize(ZonaRosaMutPointerPreKeyZonaRosaMessage *out, ZonaRosaBorrowedBuffer data);

ZonaRosaFfiError *zonarosa_pre_key_zonarosa_message_destroy(ZonaRosaMutPointerPreKeyZonaRosaMessage p);

ZonaRosaFfiError *zonarosa_pre_key_zonarosa_message_get_base_key(ZonaRosaMutPointerPublicKey *out, ZonaRosaConstPointerPreKeyZonaRosaMessage m);

ZonaRosaFfiError *zonarosa_pre_key_zonarosa_message_get_identity_key(ZonaRosaMutPointerPublicKey *out, ZonaRosaConstPointerPreKeyZonaRosaMessage m);

ZonaRosaFfiError *zonarosa_pre_key_zonarosa_message_get_pre_key_id(uint32_t *out, ZonaRosaConstPointerPreKeyZonaRosaMessage obj);

ZonaRosaFfiError *zonarosa_pre_key_zonarosa_message_get_registration_id(uint32_t *out, ZonaRosaConstPointerPreKeyZonaRosaMessage obj);

ZonaRosaFfiError *zonarosa_pre_key_zonarosa_message_get_zonarosa_message(ZonaRosaMutPointerZonaRosaMessage *out, ZonaRosaConstPointerPreKeyZonaRosaMessage m);

ZonaRosaFfiError *zonarosa_pre_key_zonarosa_message_get_signed_pre_key_id(uint32_t *out, ZonaRosaConstPointerPreKeyZonaRosaMessage obj);

ZonaRosaFfiError *zonarosa_pre_key_zonarosa_message_get_version(uint32_t *out, ZonaRosaConstPointerPreKeyZonaRosaMessage obj);

ZonaRosaFfiError *zonarosa_pre_key_zonarosa_message_new(ZonaRosaMutPointerPreKeyZonaRosaMessage *out, uint8_t message_version, uint32_t registration_id, uint32_t pre_key_id, uint32_t signed_pre_key_id, ZonaRosaConstPointerPublicKey base_key, ZonaRosaConstPointerPublicKey identity_key, ZonaRosaConstPointerZonaRosaMessage zonarosa_message);

ZonaRosaFfiError *zonarosa_pre_key_zonarosa_message_serialize(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerPreKeyZonaRosaMessage obj);

void zonarosa_print_ptr(const void *p);

ZonaRosaFfiError *zonarosa_privatekey_agree(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerPrivateKey private_key, ZonaRosaConstPointerPublicKey public_key);

ZonaRosaFfiError *zonarosa_privatekey_clone(ZonaRosaMutPointerPrivateKey *new_obj, ZonaRosaConstPointerPrivateKey obj);

ZonaRosaFfiError *zonarosa_privatekey_deserialize(ZonaRosaMutPointerPrivateKey *out, ZonaRosaBorrowedBuffer data);

ZonaRosaFfiError *zonarosa_privatekey_destroy(ZonaRosaMutPointerPrivateKey p);

ZonaRosaFfiError *zonarosa_privatekey_generate(ZonaRosaMutPointerPrivateKey *out);

ZonaRosaFfiError *zonarosa_privatekey_get_public_key(ZonaRosaMutPointerPublicKey *out, ZonaRosaConstPointerPrivateKey k);

ZonaRosaFfiError *zonarosa_privatekey_hpke_open(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerPrivateKey sk, ZonaRosaBorrowedBuffer ciphertext, ZonaRosaBorrowedBuffer info, ZonaRosaBorrowedBuffer associated_data);

ZonaRosaFfiError *zonarosa_privatekey_serialize(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerPrivateKey obj);

ZonaRosaFfiError *zonarosa_privatekey_sign(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerPrivateKey key, ZonaRosaBorrowedBuffer message);

ZonaRosaFfiError *zonarosa_process_prekey_bundle(ZonaRosaConstPointerPreKeyBundle bundle, ZonaRosaConstPointerProtocolAddress protocol_address, ZonaRosaConstPointerFfiSessionStoreStruct session_store, ZonaRosaConstPointerFfiIdentityKeyStoreStruct identity_key_store, uint64_t now);

ZonaRosaFfiError *zonarosa_process_sender_key_distribution_message(ZonaRosaConstPointerProtocolAddress sender, ZonaRosaConstPointerSenderKeyDistributionMessage sender_key_distribution_message, ZonaRosaConstPointerFfiSenderKeyStoreStruct store);

ZonaRosaFfiError *zonarosa_profile_key_check_valid_contents(ZonaRosaBorrowedBuffer buffer);

ZonaRosaFfiError *zonarosa_profile_key_ciphertext_check_valid_contents(ZonaRosaBorrowedBuffer buffer);

ZonaRosaFfiError *zonarosa_profile_key_commitment_check_valid_contents(ZonaRosaBorrowedBuffer buffer);

ZonaRosaFfiError *zonarosa_profile_key_credential_presentation_check_valid_contents(ZonaRosaBorrowedBuffer presentation_bytes);

ZonaRosaFfiError *zonarosa_profile_key_credential_presentation_get_profile_key_ciphertext(unsigned char (*out)[ZonaRosaPROFILE_KEY_CIPHERTEXT_LEN], ZonaRosaBorrowedBuffer presentation_bytes);

ZonaRosaFfiError *zonarosa_profile_key_credential_presentation_get_uuid_ciphertext(unsigned char (*out)[ZonaRosaUUID_CIPHERTEXT_LEN], ZonaRosaBorrowedBuffer presentation_bytes);

ZonaRosaFfiError *zonarosa_profile_key_credential_request_check_valid_contents(ZonaRosaBorrowedBuffer buffer);

ZonaRosaFfiError *zonarosa_profile_key_credential_request_context_check_valid_contents(ZonaRosaBorrowedBuffer buffer);

ZonaRosaFfiError *zonarosa_profile_key_credential_request_context_get_request(unsigned char (*out)[ZonaRosaPROFILE_KEY_CREDENTIAL_REQUEST_LEN], const unsigned char (*context)[ZonaRosaPROFILE_KEY_CREDENTIAL_REQUEST_CONTEXT_LEN]);

ZonaRosaFfiError *zonarosa_profile_key_derive_access_key(uint8_t (*out)[ZonaRosaACCESS_KEY_LEN], const unsigned char (*profile_key)[ZonaRosaPROFILE_KEY_LEN]);

ZonaRosaFfiError *zonarosa_profile_key_get_commitment(unsigned char (*out)[ZonaRosaPROFILE_KEY_COMMITMENT_LEN], const unsigned char (*profile_key)[ZonaRosaPROFILE_KEY_LEN], const ZonaRosaServiceIdFixedWidthBinaryBytes *user_id);

ZonaRosaFfiError *zonarosa_profile_key_get_profile_key_version(uint8_t (*out)[ZonaRosaPROFILE_KEY_VERSION_ENCODED_LEN], const unsigned char (*profile_key)[ZonaRosaPROFILE_KEY_LEN], const ZonaRosaServiceIdFixedWidthBinaryBytes *user_id);

ZonaRosaFfiError *zonarosa_provisioning_chat_connection_connect(ZonaRosaCPromiseMutPointerProvisioningChatConnection *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, ZonaRosaConstPointerConnectionManager connection_manager);

ZonaRosaFfiError *zonarosa_provisioning_chat_connection_destroy(ZonaRosaMutPointerProvisioningChatConnection p);

ZonaRosaFfiError *zonarosa_provisioning_chat_connection_disconnect(ZonaRosaCPromisebool *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, ZonaRosaConstPointerProvisioningChatConnection chat);

ZonaRosaFfiError *zonarosa_provisioning_chat_connection_info(ZonaRosaMutPointerChatConnectionInfo *out, ZonaRosaConstPointerProvisioningChatConnection chat);

ZonaRosaFfiError *zonarosa_provisioning_chat_connection_init_listener(ZonaRosaConstPointerProvisioningChatConnection chat, ZonaRosaConstPointerFfiProvisioningListenerStruct listener);

ZonaRosaFfiError *zonarosa_publickey_clone(ZonaRosaMutPointerPublicKey *new_obj, ZonaRosaConstPointerPublicKey obj);

ZonaRosaFfiError *zonarosa_publickey_deserialize(ZonaRosaMutPointerPublicKey *out, ZonaRosaBorrowedBuffer data);

ZonaRosaFfiError *zonarosa_publickey_destroy(ZonaRosaMutPointerPublicKey p);

ZonaRosaFfiError *zonarosa_publickey_equals(bool *out, ZonaRosaConstPointerPublicKey lhs, ZonaRosaConstPointerPublicKey rhs);

ZonaRosaFfiError *zonarosa_publickey_get_public_key_bytes(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerPublicKey obj);

ZonaRosaFfiError *zonarosa_publickey_hpke_seal(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerPublicKey pk, ZonaRosaBorrowedBuffer plaintext, ZonaRosaBorrowedBuffer info, ZonaRosaBorrowedBuffer associated_data);

ZonaRosaFfiError *zonarosa_publickey_serialize(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerPublicKey obj);

ZonaRosaFfiError *zonarosa_publickey_verify(bool *out, ZonaRosaConstPointerPublicKey key, ZonaRosaBorrowedBuffer message, ZonaRosaBorrowedBuffer signature);

ZonaRosaFfiError *zonarosa_receipt_credential_check_valid_contents(ZonaRosaBorrowedBuffer buffer);

ZonaRosaFfiError *zonarosa_receipt_credential_get_receipt_expiration_time(uint64_t *out, const unsigned char (*receipt_credential)[ZonaRosaRECEIPT_CREDENTIAL_LEN]);

ZonaRosaFfiError *zonarosa_receipt_credential_get_receipt_level(uint64_t *out, const unsigned char (*receipt_credential)[ZonaRosaRECEIPT_CREDENTIAL_LEN]);

ZonaRosaFfiError *zonarosa_receipt_credential_presentation_check_valid_contents(ZonaRosaBorrowedBuffer buffer);

ZonaRosaFfiError *zonarosa_receipt_credential_presentation_get_receipt_expiration_time(uint64_t *out, const unsigned char (*presentation)[ZonaRosaRECEIPT_CREDENTIAL_PRESENTATION_LEN]);

ZonaRosaFfiError *zonarosa_receipt_credential_presentation_get_receipt_level(uint64_t *out, const unsigned char (*presentation)[ZonaRosaRECEIPT_CREDENTIAL_PRESENTATION_LEN]);

ZonaRosaFfiError *zonarosa_receipt_credential_presentation_get_receipt_serial(uint8_t (*out)[ZonaRosaRECEIPT_SERIAL_LEN], const unsigned char (*presentation)[ZonaRosaRECEIPT_CREDENTIAL_PRESENTATION_LEN]);

ZonaRosaFfiError *zonarosa_receipt_credential_request_check_valid_contents(ZonaRosaBorrowedBuffer buffer);

ZonaRosaFfiError *zonarosa_receipt_credential_request_context_check_valid_contents(ZonaRosaBorrowedBuffer buffer);

ZonaRosaFfiError *zonarosa_receipt_credential_request_context_get_request(unsigned char (*out)[ZonaRosaRECEIPT_CREDENTIAL_REQUEST_LEN], const unsigned char (*request_context)[ZonaRosaRECEIPT_CREDENTIAL_REQUEST_CONTEXT_LEN]);

ZonaRosaFfiError *zonarosa_receipt_credential_response_check_valid_contents(ZonaRosaBorrowedBuffer buffer);

ZonaRosaFfiError *zonarosa_register_account_request_create(ZonaRosaMutPointerRegisterAccountRequest *out);

ZonaRosaFfiError *zonarosa_register_account_request_destroy(ZonaRosaMutPointerRegisterAccountRequest p);

ZonaRosaFfiError *zonarosa_register_account_request_set_account_password(ZonaRosaConstPointerRegisterAccountRequest register_account, const char *account_password);

ZonaRosaFfiError *zonarosa_register_account_request_set_apn_push_token(ZonaRosaConstPointerRegisterAccountRequest register_account, const char *apn_push_token);

ZonaRosaFfiError *zonarosa_register_account_request_set_identity_pq_last_resort_pre_key(ZonaRosaConstPointerRegisterAccountRequest register_account, uint8_t identity_type, ZonaRosaFfiSignedPublicPreKey pq_last_resort_pre_key);

ZonaRosaFfiError *zonarosa_register_account_request_set_identity_public_key(ZonaRosaConstPointerRegisterAccountRequest register_account, uint8_t identity_type, ZonaRosaConstPointerPublicKey identity_key);

ZonaRosaFfiError *zonarosa_register_account_request_set_identity_signed_pre_key(ZonaRosaConstPointerRegisterAccountRequest register_account, uint8_t identity_type, ZonaRosaFfiSignedPublicPreKey signed_pre_key);

ZonaRosaFfiError *zonarosa_register_account_request_set_skip_device_transfer(ZonaRosaConstPointerRegisterAccountRequest register_account);

ZonaRosaFfiError *zonarosa_register_account_response_destroy(ZonaRosaMutPointerRegisterAccountResponse p);

ZonaRosaFfiError *zonarosa_register_account_response_get_entitlement_backup_expiration_seconds(uint64_t *out, ZonaRosaConstPointerRegisterAccountResponse response);

ZonaRosaFfiError *zonarosa_register_account_response_get_entitlement_backup_level(uint64_t *out, ZonaRosaConstPointerRegisterAccountResponse response);

ZonaRosaFfiError *zonarosa_register_account_response_get_entitlement_badges(ZonaRosaOwnedBufferOfFfiRegisterResponseBadge *out, ZonaRosaConstPointerRegisterAccountResponse response);

ZonaRosaFfiError *zonarosa_register_account_response_get_identity(ZonaRosaServiceIdFixedWidthBinaryBytes *out, ZonaRosaConstPointerRegisterAccountResponse response, uint8_t identity_type);

ZonaRosaFfiError *zonarosa_register_account_response_get_number(const char **out, ZonaRosaConstPointerRegisterAccountResponse response);

ZonaRosaFfiError *zonarosa_register_account_response_get_reregistration(bool *out, ZonaRosaConstPointerRegisterAccountResponse response);

ZonaRosaFfiError *zonarosa_register_account_response_get_storage_capable(bool *out, ZonaRosaConstPointerRegisterAccountResponse response);

ZonaRosaFfiError *zonarosa_register_account_response_get_username_hash(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerRegisterAccountResponse response);

ZonaRosaFfiError *zonarosa_register_account_response_get_username_link_handle(ZonaRosaOptionalUuid *out, ZonaRosaConstPointerRegisterAccountResponse response);

ZonaRosaFfiError *zonarosa_registration_account_attributes_create(ZonaRosaMutPointerRegistrationAccountAttributes *out, ZonaRosaBorrowedBuffer recovery_password, uint16_t aci_registration_id, uint16_t pni_registration_id, const char *registration_lock, const uint8_t (*unidentified_access_key)[16], bool unrestricted_unidentified_access, ZonaRosaBorrowedBytestringArray capabilities, bool discoverable_by_phone_number);

ZonaRosaFfiError *zonarosa_registration_account_attributes_destroy(ZonaRosaMutPointerRegistrationAccountAttributes p);

ZonaRosaFfiError *zonarosa_registration_service_check_svr2_credentials(ZonaRosaCPromiseFfiCheckSvr2CredentialsResponse *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, ZonaRosaConstPointerRegistrationService service, ZonaRosaBorrowedBytestringArray svr_tokens);

ZonaRosaFfiError *zonarosa_registration_service_create_session(ZonaRosaCPromiseMutPointerRegistrationService *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, ZonaRosaFfiRegistrationCreateSessionRequest create_session, ZonaRosaConstPointerFfiConnectChatBridgeStruct connect_chat);

ZonaRosaFfiError *zonarosa_registration_service_destroy(ZonaRosaMutPointerRegistrationService p);

ZonaRosaFfiError *zonarosa_registration_service_register_account(ZonaRosaCPromiseMutPointerRegisterAccountResponse *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, ZonaRosaConstPointerRegistrationService service, ZonaRosaConstPointerRegisterAccountRequest register_account, ZonaRosaConstPointerRegistrationAccountAttributes account_attributes);

ZonaRosaFfiError *zonarosa_registration_service_registration_session(ZonaRosaMutPointerRegistrationSession *out, ZonaRosaConstPointerRegistrationService service);

ZonaRosaFfiError *zonarosa_registration_service_request_push_challenge(ZonaRosaCPromisebool *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, ZonaRosaConstPointerRegistrationService service, const char *push_token);

ZonaRosaFfiError *zonarosa_registration_service_request_verification_code(ZonaRosaCPromisebool *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, ZonaRosaConstPointerRegistrationService service, const char *transport, const char *client, ZonaRosaBorrowedBytestringArray languages);

ZonaRosaFfiError *zonarosa_registration_service_reregister_account(ZonaRosaCPromiseMutPointerRegisterAccountResponse *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, ZonaRosaConstPointerFfiConnectChatBridgeStruct connect_chat, const char *number, ZonaRosaConstPointerRegisterAccountRequest register_account, ZonaRosaConstPointerRegistrationAccountAttributes account_attributes);

ZonaRosaFfiError *zonarosa_registration_service_resume_session(ZonaRosaCPromiseMutPointerRegistrationService *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, const char *session_id, const char *number, ZonaRosaConstPointerFfiConnectChatBridgeStruct connect_chat);

ZonaRosaFfiError *zonarosa_registration_service_session_id(const char **out, ZonaRosaConstPointerRegistrationService service);

ZonaRosaFfiError *zonarosa_registration_service_submit_captcha(ZonaRosaCPromisebool *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, ZonaRosaConstPointerRegistrationService service, const char *captcha_value);

ZonaRosaFfiError *zonarosa_registration_service_submit_push_challenge(ZonaRosaCPromisebool *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, ZonaRosaConstPointerRegistrationService service, const char *push_challenge);

ZonaRosaFfiError *zonarosa_registration_service_submit_verification_code(ZonaRosaCPromisebool *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, ZonaRosaConstPointerRegistrationService service, const char *code);

ZonaRosaFfiError *zonarosa_registration_session_destroy(ZonaRosaMutPointerRegistrationSession p);

ZonaRosaFfiError *zonarosa_registration_session_get_allowed_to_request_code(bool *out, ZonaRosaConstPointerRegistrationSession session);

ZonaRosaFfiError *zonarosa_registration_session_get_next_call_seconds(uint32_t *out, ZonaRosaConstPointerRegistrationSession session);

ZonaRosaFfiError *zonarosa_registration_session_get_next_sms_seconds(uint32_t *out, ZonaRosaConstPointerRegistrationSession session);

ZonaRosaFfiError *zonarosa_registration_session_get_next_verification_attempt_seconds(uint32_t *out, ZonaRosaConstPointerRegistrationSession session);

ZonaRosaFfiError *zonarosa_registration_session_get_requested_information(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerRegistrationSession session);

ZonaRosaFfiError *zonarosa_registration_session_get_verified(bool *out, ZonaRosaConstPointerRegistrationSession session);

ZonaRosaFfiError *zonarosa_sanitized_metadata_clone(ZonaRosaMutPointerSanitizedMetadata *new_obj, ZonaRosaConstPointerSanitizedMetadata obj);

ZonaRosaFfiError *zonarosa_sanitized_metadata_destroy(ZonaRosaMutPointerSanitizedMetadata p);

ZonaRosaFfiError *zonarosa_sanitized_metadata_get_data_len(uint64_t *out, ZonaRosaConstPointerSanitizedMetadata sanitized);

ZonaRosaFfiError *zonarosa_sanitized_metadata_get_data_offset(uint64_t *out, ZonaRosaConstPointerSanitizedMetadata sanitized);

ZonaRosaFfiError *zonarosa_sanitized_metadata_get_metadata(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerSanitizedMetadata sanitized);

ZonaRosaFfiError *zonarosa_sealed_sender_multi_recipient_encrypt(ZonaRosaOwnedBuffer *out, ZonaRosaBorrowedSliceOfConstPointerProtocolAddress recipients, ZonaRosaBorrowedSliceOfConstPointerSessionRecord recipient_sessions, ZonaRosaBorrowedBuffer excluded_recipients, ZonaRosaConstPointerUnidentifiedSenderMessageContent content, ZonaRosaConstPointerFfiIdentityKeyStoreStruct identity_key_store);

ZonaRosaFfiError *zonarosa_sealed_sender_multi_recipient_message_for_single_recipient(ZonaRosaOwnedBuffer *out, ZonaRosaBorrowedBuffer encoded_multi_recipient_message);

ZonaRosaFfiError *zonarosa_sealed_session_cipher_decrypt_to_usmc(ZonaRosaMutPointerUnidentifiedSenderMessageContent *out, ZonaRosaBorrowedBuffer ctext, ZonaRosaConstPointerFfiIdentityKeyStoreStruct identity_store);

ZonaRosaFfiError *zonarosa_sealed_session_cipher_encrypt(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerProtocolAddress destination, ZonaRosaConstPointerUnidentifiedSenderMessageContent content, ZonaRosaConstPointerFfiIdentityKeyStoreStruct identity_key_store);

ZonaRosaFfiError *zonarosa_secure_value_recovery_for_backups_create_new_backup_chain(ZonaRosaOwnedBuffer *out, uint8_t environment, const ZonaRosaBackupKeyBytes *backup_key);

ZonaRosaFfiError *zonarosa_secure_value_recovery_for_backups_remove_backup(ZonaRosaCPromisebool *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, ZonaRosaConstPointerConnectionManager connection_manager, const char *username, const char *password);

ZonaRosaFfiError *zonarosa_secure_value_recovery_for_backups_restore_backup_from_server(ZonaRosaCPromiseMutPointerBackupRestoreResponse *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, const ZonaRosaBackupKeyBytes *backup_key, ZonaRosaBorrowedBuffer metadata, ZonaRosaConstPointerConnectionManager connection_manager, const char *username, const char *password);

ZonaRosaFfiError *zonarosa_secure_value_recovery_for_backups_store_backup(ZonaRosaCPromiseMutPointerBackupStoreResponse *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, const ZonaRosaBackupKeyBytes *backup_key, ZonaRosaBorrowedBuffer previous_secret_data, ZonaRosaConstPointerConnectionManager connection_manager, const char *username, const char *password);

ZonaRosaFfiError *zonarosa_sender_certificate_clone(ZonaRosaMutPointerSenderCertificate *new_obj, ZonaRosaConstPointerSenderCertificate obj);

ZonaRosaFfiError *zonarosa_sender_certificate_deserialize(ZonaRosaMutPointerSenderCertificate *out, ZonaRosaBorrowedBuffer data);

ZonaRosaFfiError *zonarosa_sender_certificate_destroy(ZonaRosaMutPointerSenderCertificate p);

ZonaRosaFfiError *zonarosa_sender_certificate_get_certificate(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerSenderCertificate obj);

ZonaRosaFfiError *zonarosa_sender_certificate_get_device_id(uint32_t *out, ZonaRosaConstPointerSenderCertificate obj);

ZonaRosaFfiError *zonarosa_sender_certificate_get_expiration(uint64_t *out, ZonaRosaConstPointerSenderCertificate obj);

ZonaRosaFfiError *zonarosa_sender_certificate_get_key(ZonaRosaMutPointerPublicKey *out, ZonaRosaConstPointerSenderCertificate obj);

ZonaRosaFfiError *zonarosa_sender_certificate_get_sender_e164(const char **out, ZonaRosaConstPointerSenderCertificate obj);

ZonaRosaFfiError *zonarosa_sender_certificate_get_sender_uuid(const char **out, ZonaRosaConstPointerSenderCertificate obj);

ZonaRosaFfiError *zonarosa_sender_certificate_get_serialized(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerSenderCertificate obj);

ZonaRosaFfiError *zonarosa_sender_certificate_get_server_certificate(ZonaRosaMutPointerServerCertificate *out, ZonaRosaConstPointerSenderCertificate cert);

ZonaRosaFfiError *zonarosa_sender_certificate_get_signature(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerSenderCertificate obj);

ZonaRosaFfiError *zonarosa_sender_certificate_new(ZonaRosaMutPointerSenderCertificate *out, const char *sender_uuid, const char *sender_e164, uint32_t sender_device_id, ZonaRosaConstPointerPublicKey sender_key, uint64_t expiration, ZonaRosaConstPointerServerCertificate signer_cert, ZonaRosaConstPointerPrivateKey signer_key);

ZonaRosaFfiError *zonarosa_sender_certificate_validate(bool *out, ZonaRosaConstPointerSenderCertificate cert, ZonaRosaBorrowedSliceOfConstPointerPublicKey trust_roots, uint64_t time);

ZonaRosaFfiError *zonarosa_sender_key_distribution_message_clone(ZonaRosaMutPointerSenderKeyDistributionMessage *new_obj, ZonaRosaConstPointerSenderKeyDistributionMessage obj);

ZonaRosaFfiError *zonarosa_sender_key_distribution_message_create(ZonaRosaMutPointerSenderKeyDistributionMessage *out, ZonaRosaConstPointerProtocolAddress sender, ZonaRosaUuid distribution_id, ZonaRosaConstPointerFfiSenderKeyStoreStruct store);

ZonaRosaFfiError *zonarosa_sender_key_distribution_message_deserialize(ZonaRosaMutPointerSenderKeyDistributionMessage *out, ZonaRosaBorrowedBuffer data);

ZonaRosaFfiError *zonarosa_sender_key_distribution_message_destroy(ZonaRosaMutPointerSenderKeyDistributionMessage p);

ZonaRosaFfiError *zonarosa_sender_key_distribution_message_get_chain_id(uint32_t *out, ZonaRosaConstPointerSenderKeyDistributionMessage obj);

ZonaRosaFfiError *zonarosa_sender_key_distribution_message_get_chain_key(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerSenderKeyDistributionMessage obj);

ZonaRosaFfiError *zonarosa_sender_key_distribution_message_get_distribution_id(ZonaRosaUuid *out, ZonaRosaConstPointerSenderKeyDistributionMessage obj);

ZonaRosaFfiError *zonarosa_sender_key_distribution_message_get_iteration(uint32_t *out, ZonaRosaConstPointerSenderKeyDistributionMessage obj);

ZonaRosaFfiError *zonarosa_sender_key_distribution_message_get_signature_key(ZonaRosaMutPointerPublicKey *out, ZonaRosaConstPointerSenderKeyDistributionMessage m);

ZonaRosaFfiError *zonarosa_sender_key_distribution_message_new(ZonaRosaMutPointerSenderKeyDistributionMessage *out, uint8_t message_version, ZonaRosaUuid distribution_id, uint32_t chain_id, uint32_t iteration, ZonaRosaBorrowedBuffer chainkey, ZonaRosaConstPointerPublicKey pk);

ZonaRosaFfiError *zonarosa_sender_key_distribution_message_serialize(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerSenderKeyDistributionMessage obj);

ZonaRosaFfiError *zonarosa_sender_key_message_clone(ZonaRosaMutPointerSenderKeyMessage *new_obj, ZonaRosaConstPointerSenderKeyMessage obj);

ZonaRosaFfiError *zonarosa_sender_key_message_deserialize(ZonaRosaMutPointerSenderKeyMessage *out, ZonaRosaBorrowedBuffer data);

ZonaRosaFfiError *zonarosa_sender_key_message_destroy(ZonaRosaMutPointerSenderKeyMessage p);

ZonaRosaFfiError *zonarosa_sender_key_message_get_chain_id(uint32_t *out, ZonaRosaConstPointerSenderKeyMessage obj);

ZonaRosaFfiError *zonarosa_sender_key_message_get_cipher_text(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerSenderKeyMessage obj);

ZonaRosaFfiError *zonarosa_sender_key_message_get_distribution_id(ZonaRosaUuid *out, ZonaRosaConstPointerSenderKeyMessage obj);

ZonaRosaFfiError *zonarosa_sender_key_message_get_iteration(uint32_t *out, ZonaRosaConstPointerSenderKeyMessage obj);

ZonaRosaFfiError *zonarosa_sender_key_message_new(ZonaRosaMutPointerSenderKeyMessage *out, uint8_t message_version, ZonaRosaUuid distribution_id, uint32_t chain_id, uint32_t iteration, ZonaRosaBorrowedBuffer ciphertext, ZonaRosaConstPointerPrivateKey pk);

ZonaRosaFfiError *zonarosa_sender_key_message_serialize(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerSenderKeyMessage obj);

ZonaRosaFfiError *zonarosa_sender_key_message_verify_signature(bool *out, ZonaRosaConstPointerSenderKeyMessage skm, ZonaRosaConstPointerPublicKey pubkey);

ZonaRosaFfiError *zonarosa_sender_key_record_clone(ZonaRosaMutPointerSenderKeyRecord *new_obj, ZonaRosaConstPointerSenderKeyRecord obj);

ZonaRosaFfiError *zonarosa_sender_key_record_deserialize(ZonaRosaMutPointerSenderKeyRecord *out, ZonaRosaBorrowedBuffer data);

ZonaRosaFfiError *zonarosa_sender_key_record_destroy(ZonaRosaMutPointerSenderKeyRecord p);

ZonaRosaFfiError *zonarosa_sender_key_record_serialize(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerSenderKeyRecord obj);

ZonaRosaFfiError *zonarosa_server_certificate_clone(ZonaRosaMutPointerServerCertificate *new_obj, ZonaRosaConstPointerServerCertificate obj);

ZonaRosaFfiError *zonarosa_server_certificate_deserialize(ZonaRosaMutPointerServerCertificate *out, ZonaRosaBorrowedBuffer data);

ZonaRosaFfiError *zonarosa_server_certificate_destroy(ZonaRosaMutPointerServerCertificate p);

ZonaRosaFfiError *zonarosa_server_certificate_get_certificate(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerServerCertificate obj);

ZonaRosaFfiError *zonarosa_server_certificate_get_key(ZonaRosaMutPointerPublicKey *out, ZonaRosaConstPointerServerCertificate obj);

ZonaRosaFfiError *zonarosa_server_certificate_get_key_id(uint32_t *out, ZonaRosaConstPointerServerCertificate obj);

ZonaRosaFfiError *zonarosa_server_certificate_get_serialized(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerServerCertificate obj);

ZonaRosaFfiError *zonarosa_server_certificate_get_signature(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerServerCertificate obj);

ZonaRosaFfiError *zonarosa_server_certificate_new(ZonaRosaMutPointerServerCertificate *out, uint32_t key_id, ZonaRosaConstPointerPublicKey server_key, ZonaRosaConstPointerPrivateKey trust_root);

ZonaRosaFfiError *zonarosa_server_message_ack_destroy(ZonaRosaMutPointerServerMessageAck p);

ZonaRosaFfiError *zonarosa_server_message_ack_send(ZonaRosaConstPointerServerMessageAck ack);

ZonaRosaFfiError *zonarosa_server_public_params_create_auth_credential_with_pni_presentation_deterministic(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerServerPublicParams server_public_params, const uint8_t (*randomness)[ZonaRosaRANDOMNESS_LEN], const unsigned char (*group_secret_params)[ZonaRosaGROUP_SECRET_PARAMS_LEN], ZonaRosaBorrowedBuffer auth_credential_with_pni_bytes);

ZonaRosaFfiError *zonarosa_server_public_params_create_expiring_profile_key_credential_presentation_deterministic(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerServerPublicParams server_public_params, const uint8_t (*randomness)[ZonaRosaRANDOMNESS_LEN], const unsigned char (*group_secret_params)[ZonaRosaGROUP_SECRET_PARAMS_LEN], const unsigned char (*profile_key_credential)[ZonaRosaEXPIRING_PROFILE_KEY_CREDENTIAL_LEN]);

ZonaRosaFfiError *zonarosa_server_public_params_create_profile_key_credential_request_context_deterministic(unsigned char (*out)[ZonaRosaPROFILE_KEY_CREDENTIAL_REQUEST_CONTEXT_LEN], ZonaRosaConstPointerServerPublicParams server_public_params, const uint8_t (*randomness)[ZonaRosaRANDOMNESS_LEN], const ZonaRosaServiceIdFixedWidthBinaryBytes *user_id, const unsigned char (*profile_key)[ZonaRosaPROFILE_KEY_LEN]);

ZonaRosaFfiError *zonarosa_server_public_params_create_receipt_credential_presentation_deterministic(unsigned char (*out)[ZonaRosaRECEIPT_CREDENTIAL_PRESENTATION_LEN], ZonaRosaConstPointerServerPublicParams server_public_params, const uint8_t (*randomness)[ZonaRosaRANDOMNESS_LEN], const unsigned char (*receipt_credential)[ZonaRosaRECEIPT_CREDENTIAL_LEN]);

ZonaRosaFfiError *zonarosa_server_public_params_create_receipt_credential_request_context_deterministic(unsigned char (*out)[ZonaRosaRECEIPT_CREDENTIAL_REQUEST_CONTEXT_LEN], ZonaRosaConstPointerServerPublicParams server_public_params, const uint8_t (*randomness)[ZonaRosaRANDOMNESS_LEN], const uint8_t (*receipt_serial)[ZonaRosaRECEIPT_SERIAL_LEN]);

ZonaRosaFfiError *zonarosa_server_public_params_deserialize(ZonaRosaMutPointerServerPublicParams *out, ZonaRosaBorrowedBuffer buffer);

ZonaRosaFfiError *zonarosa_server_public_params_destroy(ZonaRosaMutPointerServerPublicParams p);

ZonaRosaFfiError *zonarosa_server_public_params_get_endorsement_public_key(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerServerPublicParams params);

ZonaRosaFfiError *zonarosa_server_public_params_receive_auth_credential_with_pni_as_service_id(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerServerPublicParams params, const ZonaRosaServiceIdFixedWidthBinaryBytes *aci, const ZonaRosaServiceIdFixedWidthBinaryBytes *pni, uint64_t redemption_time, ZonaRosaBorrowedBuffer auth_credential_with_pni_response_bytes);

ZonaRosaFfiError *zonarosa_server_public_params_receive_expiring_profile_key_credential(unsigned char (*out)[ZonaRosaEXPIRING_PROFILE_KEY_CREDENTIAL_LEN], ZonaRosaConstPointerServerPublicParams server_public_params, const unsigned char (*request_context)[ZonaRosaPROFILE_KEY_CREDENTIAL_REQUEST_CONTEXT_LEN], const unsigned char (*response)[ZonaRosaEXPIRING_PROFILE_KEY_CREDENTIAL_RESPONSE_LEN], uint64_t current_time_in_seconds);

ZonaRosaFfiError *zonarosa_server_public_params_receive_receipt_credential(unsigned char (*out)[ZonaRosaRECEIPT_CREDENTIAL_LEN], ZonaRosaConstPointerServerPublicParams server_public_params, const unsigned char (*request_context)[ZonaRosaRECEIPT_CREDENTIAL_REQUEST_CONTEXT_LEN], const unsigned char (*response)[ZonaRosaRECEIPT_CREDENTIAL_RESPONSE_LEN]);

ZonaRosaFfiError *zonarosa_server_public_params_serialize(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerServerPublicParams handle);

ZonaRosaFfiError *zonarosa_server_public_params_verify_signature(ZonaRosaConstPointerServerPublicParams server_public_params, ZonaRosaBorrowedBuffer message, const uint8_t (*notary_signature)[ZonaRosaSIGNATURE_LEN]);

ZonaRosaFfiError *zonarosa_server_secret_params_deserialize(ZonaRosaMutPointerServerSecretParams *out, ZonaRosaBorrowedBuffer buffer);

ZonaRosaFfiError *zonarosa_server_secret_params_destroy(ZonaRosaMutPointerServerSecretParams p);

ZonaRosaFfiError *zonarosa_server_secret_params_generate_deterministic(ZonaRosaMutPointerServerSecretParams *out, const uint8_t (*randomness)[ZonaRosaRANDOMNESS_LEN]);

ZonaRosaFfiError *zonarosa_server_secret_params_get_public_params(ZonaRosaMutPointerServerPublicParams *out, ZonaRosaConstPointerServerSecretParams params);

ZonaRosaFfiError *zonarosa_server_secret_params_issue_auth_credential_with_pni_zkc_deterministic(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerServerSecretParams server_secret_params, const uint8_t (*randomness)[ZonaRosaRANDOMNESS_LEN], const ZonaRosaServiceIdFixedWidthBinaryBytes *aci, const ZonaRosaServiceIdFixedWidthBinaryBytes *pni, uint64_t redemption_time);

ZonaRosaFfiError *zonarosa_server_secret_params_issue_expiring_profile_key_credential_deterministic(unsigned char (*out)[ZonaRosaEXPIRING_PROFILE_KEY_CREDENTIAL_RESPONSE_LEN], ZonaRosaConstPointerServerSecretParams server_secret_params, const uint8_t (*randomness)[ZonaRosaRANDOMNESS_LEN], const unsigned char (*request)[ZonaRosaPROFILE_KEY_CREDENTIAL_REQUEST_LEN], const ZonaRosaServiceIdFixedWidthBinaryBytes *user_id, const unsigned char (*commitment)[ZonaRosaPROFILE_KEY_COMMITMENT_LEN], uint64_t expiration_in_seconds);

ZonaRosaFfiError *zonarosa_server_secret_params_issue_receipt_credential_deterministic(unsigned char (*out)[ZonaRosaRECEIPT_CREDENTIAL_RESPONSE_LEN], ZonaRosaConstPointerServerSecretParams server_secret_params, const uint8_t (*randomness)[ZonaRosaRANDOMNESS_LEN], const unsigned char (*request)[ZonaRosaRECEIPT_CREDENTIAL_REQUEST_LEN], uint64_t receipt_expiration_time, uint64_t receipt_level);

ZonaRosaFfiError *zonarosa_server_secret_params_serialize(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerServerSecretParams handle);

ZonaRosaFfiError *zonarosa_server_secret_params_sign_deterministic(uint8_t (*out)[ZonaRosaSIGNATURE_LEN], ZonaRosaConstPointerServerSecretParams params, const uint8_t (*randomness)[ZonaRosaRANDOMNESS_LEN], ZonaRosaBorrowedBuffer message);

ZonaRosaFfiError *zonarosa_server_secret_params_verify_auth_credential_presentation(ZonaRosaConstPointerServerSecretParams server_secret_params, const unsigned char (*group_public_params)[ZonaRosaGROUP_PUBLIC_PARAMS_LEN], ZonaRosaBorrowedBuffer presentation_bytes, uint64_t current_time_in_seconds);

ZonaRosaFfiError *zonarosa_server_secret_params_verify_profile_key_credential_presentation(ZonaRosaConstPointerServerSecretParams server_secret_params, const unsigned char (*group_public_params)[ZonaRosaGROUP_PUBLIC_PARAMS_LEN], ZonaRosaBorrowedBuffer presentation_bytes, uint64_t current_time_in_seconds);

ZonaRosaFfiError *zonarosa_server_secret_params_verify_receipt_credential_presentation(ZonaRosaConstPointerServerSecretParams server_secret_params, const unsigned char (*presentation)[ZonaRosaRECEIPT_CREDENTIAL_PRESENTATION_LEN]);

ZonaRosaFfiError *zonarosa_service_id_parse_from_service_id_binary(ZonaRosaServiceIdFixedWidthBinaryBytes *out, ZonaRosaBorrowedBuffer input);

ZonaRosaFfiError *zonarosa_service_id_parse_from_service_id_string(ZonaRosaServiceIdFixedWidthBinaryBytes *out, const char *input);

ZonaRosaFfiError *zonarosa_service_id_service_id_binary(ZonaRosaOwnedBuffer *out, const ZonaRosaServiceIdFixedWidthBinaryBytes *value);

ZonaRosaFfiError *zonarosa_service_id_service_id_log(const char **out, const ZonaRosaServiceIdFixedWidthBinaryBytes *value);

ZonaRosaFfiError *zonarosa_service_id_service_id_string(const char **out, const ZonaRosaServiceIdFixedWidthBinaryBytes *value);

ZonaRosaFfiError *zonarosa_session_record_archive_current_state(ZonaRosaMutPointerSessionRecord session_record);

ZonaRosaFfiError *zonarosa_session_record_clone(ZonaRosaMutPointerSessionRecord *new_obj, ZonaRosaConstPointerSessionRecord obj);

ZonaRosaFfiError *zonarosa_session_record_current_ratchet_key_matches(bool *out, ZonaRosaConstPointerSessionRecord s, ZonaRosaConstPointerPublicKey key);

ZonaRosaFfiError *zonarosa_session_record_deserialize(ZonaRosaMutPointerSessionRecord *out, ZonaRosaBorrowedBuffer data);

ZonaRosaFfiError *zonarosa_session_record_destroy(ZonaRosaMutPointerSessionRecord p);

ZonaRosaFfiError *zonarosa_session_record_get_local_registration_id(uint32_t *out, ZonaRosaConstPointerSessionRecord obj);

ZonaRosaFfiError *zonarosa_session_record_get_remote_registration_id(uint32_t *out, ZonaRosaConstPointerSessionRecord obj);

ZonaRosaFfiError *zonarosa_session_record_has_usable_sender_chain(bool *out, ZonaRosaConstPointerSessionRecord s, uint64_t now);

ZonaRosaFfiError *zonarosa_session_record_serialize(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerSessionRecord obj);

ZonaRosaFfiError *zonarosa_sgx_client_state_complete_handshake(ZonaRosaMutPointerSgxClientState cli, ZonaRosaBorrowedBuffer handshake_received);

ZonaRosaFfiError *zonarosa_sgx_client_state_destroy(ZonaRosaMutPointerSgxClientState p);

ZonaRosaFfiError *zonarosa_sgx_client_state_established_recv(ZonaRosaOwnedBuffer *out, ZonaRosaMutPointerSgxClientState cli, ZonaRosaBorrowedBuffer received_ciphertext);

ZonaRosaFfiError *zonarosa_sgx_client_state_established_send(ZonaRosaOwnedBuffer *out, ZonaRosaMutPointerSgxClientState cli, ZonaRosaBorrowedBuffer plaintext_to_send);

ZonaRosaFfiError *zonarosa_sgx_client_state_initial_request(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerSgxClientState obj);

ZonaRosaFfiError *zonarosa_zonarosa_media_check_available(void);

ZonaRosaFfiError *zonarosa_signed_pre_key_record_clone(ZonaRosaMutPointerSignedPreKeyRecord *new_obj, ZonaRosaConstPointerSignedPreKeyRecord obj);

ZonaRosaFfiError *zonarosa_signed_pre_key_record_deserialize(ZonaRosaMutPointerSignedPreKeyRecord *out, ZonaRosaBorrowedBuffer data);

ZonaRosaFfiError *zonarosa_signed_pre_key_record_destroy(ZonaRosaMutPointerSignedPreKeyRecord p);

ZonaRosaFfiError *zonarosa_signed_pre_key_record_get_id(uint32_t *out, ZonaRosaConstPointerSignedPreKeyRecord obj);

ZonaRosaFfiError *zonarosa_signed_pre_key_record_get_private_key(ZonaRosaMutPointerPrivateKey *out, ZonaRosaConstPointerSignedPreKeyRecord obj);

ZonaRosaFfiError *zonarosa_signed_pre_key_record_get_public_key(ZonaRosaMutPointerPublicKey *out, ZonaRosaConstPointerSignedPreKeyRecord obj);

ZonaRosaFfiError *zonarosa_signed_pre_key_record_get_signature(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerSignedPreKeyRecord obj);

ZonaRosaFfiError *zonarosa_signed_pre_key_record_get_timestamp(uint64_t *out, ZonaRosaConstPointerSignedPreKeyRecord obj);

ZonaRosaFfiError *zonarosa_signed_pre_key_record_new(ZonaRosaMutPointerSignedPreKeyRecord *out, uint32_t id, uint64_t timestamp, ZonaRosaConstPointerPublicKey pub_key, ZonaRosaConstPointerPrivateKey priv_key, ZonaRosaBorrowedBuffer signature);

ZonaRosaFfiError *zonarosa_signed_pre_key_record_serialize(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerSignedPreKeyRecord obj);

ZonaRosaFfiError *zonarosa_svr2_client_new(ZonaRosaMutPointerSgxClientState *out, ZonaRosaBorrowedBuffer mrenclave, ZonaRosaBorrowedBuffer attestation_msg, uint64_t current_timestamp);

ZonaRosaFfiError *zonarosa_tokio_async_context_cancel(ZonaRosaConstPointerTokioAsyncContext context, uint64_t raw_cancellation_id);

ZonaRosaFfiError *zonarosa_tokio_async_context_destroy(ZonaRosaMutPointerTokioAsyncContext p);

ZonaRosaFfiError *zonarosa_tokio_async_context_new(ZonaRosaMutPointerTokioAsyncContext *out);

ZonaRosaFfiError *zonarosa_unauthenticated_chat_connection_account_exists(ZonaRosaCPromisebool *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, ZonaRosaConstPointerUnauthenticatedChatConnection chat, const ZonaRosaServiceIdFixedWidthBinaryBytes *account);

ZonaRosaFfiError *zonarosa_unauthenticated_chat_connection_connect(ZonaRosaCPromiseMutPointerUnauthenticatedChatConnection *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, ZonaRosaConstPointerConnectionManager connection_manager, ZonaRosaBorrowedBytestringArray languages);

ZonaRosaFfiError *zonarosa_unauthenticated_chat_connection_destroy(ZonaRosaMutPointerUnauthenticatedChatConnection p);

ZonaRosaFfiError *zonarosa_unauthenticated_chat_connection_disconnect(ZonaRosaCPromisebool *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, ZonaRosaConstPointerUnauthenticatedChatConnection chat);

ZonaRosaFfiError *zonarosa_unauthenticated_chat_connection_info(ZonaRosaMutPointerChatConnectionInfo *out, ZonaRosaConstPointerUnauthenticatedChatConnection chat);

ZonaRosaFfiError *zonarosa_unauthenticated_chat_connection_init_listener(ZonaRosaConstPointerUnauthenticatedChatConnection chat, ZonaRosaConstPointerFfiChatListenerStruct listener);

ZonaRosaFfiError *zonarosa_unauthenticated_chat_connection_look_up_username_hash(ZonaRosaCPromiseOptionalUuid *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, ZonaRosaConstPointerUnauthenticatedChatConnection chat, ZonaRosaBorrowedBuffer hash);

ZonaRosaFfiError *zonarosa_unauthenticated_chat_connection_look_up_username_link(ZonaRosaCPromiseOptionalPairOfc_charu832 *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, ZonaRosaConstPointerUnauthenticatedChatConnection chat, ZonaRosaUuid uuid, ZonaRosaBorrowedBuffer entropy);

ZonaRosaFfiError *zonarosa_unauthenticated_chat_connection_send(ZonaRosaCPromiseFfiChatResponse *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, ZonaRosaConstPointerUnauthenticatedChatConnection chat, ZonaRosaConstPointerHttpRequest http_request, uint32_t timeout_millis);

ZonaRosaFfiError *zonarosa_unauthenticated_chat_connection_send_multi_recipient_message(ZonaRosaCPromiseOwnedBufferOfServiceIdFixedWidthBinaryBytes *promise, ZonaRosaConstPointerTokioAsyncContext async_runtime, ZonaRosaConstPointerUnauthenticatedChatConnection chat, ZonaRosaBorrowedBuffer payload, uint64_t timestamp, ZonaRosaBorrowedBuffer auth, bool online_only, bool is_urgent);

ZonaRosaFfiError *zonarosa_unidentified_sender_message_content_deserialize(ZonaRosaMutPointerUnidentifiedSenderMessageContent *out, ZonaRosaBorrowedBuffer data);

ZonaRosaFfiError *zonarosa_unidentified_sender_message_content_destroy(ZonaRosaMutPointerUnidentifiedSenderMessageContent p);

ZonaRosaFfiError *zonarosa_unidentified_sender_message_content_get_content_hint(uint32_t *out, ZonaRosaConstPointerUnidentifiedSenderMessageContent m);

ZonaRosaFfiError *zonarosa_unidentified_sender_message_content_get_contents(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerUnidentifiedSenderMessageContent obj);

ZonaRosaFfiError *zonarosa_unidentified_sender_message_content_get_group_id_or_empty(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerUnidentifiedSenderMessageContent m);

ZonaRosaFfiError *zonarosa_unidentified_sender_message_content_get_msg_type(uint8_t *out, ZonaRosaConstPointerUnidentifiedSenderMessageContent m);

ZonaRosaFfiError *zonarosa_unidentified_sender_message_content_get_sender_cert(ZonaRosaMutPointerSenderCertificate *out, ZonaRosaConstPointerUnidentifiedSenderMessageContent m);

ZonaRosaFfiError *zonarosa_unidentified_sender_message_content_new(ZonaRosaMutPointerUnidentifiedSenderMessageContent *out, ZonaRosaConstPointerCiphertextMessage message, ZonaRosaConstPointerSenderCertificate sender, uint32_t content_hint, ZonaRosaBorrowedBuffer group_id);

ZonaRosaFfiError *zonarosa_unidentified_sender_message_content_new_from_content_and_type(ZonaRosaMutPointerUnidentifiedSenderMessageContent *out, ZonaRosaBorrowedBuffer message_content, uint8_t message_type, ZonaRosaConstPointerSenderCertificate sender, uint32_t content_hint, ZonaRosaBorrowedBuffer group_id);

ZonaRosaFfiError *zonarosa_unidentified_sender_message_content_serialize(ZonaRosaOwnedBuffer *out, ZonaRosaConstPointerUnidentifiedSenderMessageContent obj);

ZonaRosaFfiError *zonarosa_username_candidates_from(ZonaRosaStringArray *out, const char *nickname, uint32_t min_len, uint32_t max_len);

ZonaRosaFfiError *zonarosa_username_hash(uint8_t (*out)[32], const char *username);

ZonaRosaFfiError *zonarosa_username_hash_from_parts(uint8_t (*out)[32], const char *nickname, const char *discriminator, uint32_t min_len, uint32_t max_len);

ZonaRosaFfiError *zonarosa_username_link_create(ZonaRosaOwnedBuffer *out, const char *username, ZonaRosaBorrowedBuffer entropy);

ZonaRosaFfiError *zonarosa_username_link_decrypt_username(const char **out, ZonaRosaBorrowedBuffer entropy, ZonaRosaBorrowedBuffer encrypted_username);

ZonaRosaFfiError *zonarosa_username_proof(ZonaRosaOwnedBuffer *out, const char *username, const uint8_t (*randomness)[32]);

ZonaRosaFfiError *zonarosa_username_verify(ZonaRosaBorrowedBuffer proof, ZonaRosaBorrowedBuffer hash);

ZonaRosaFfiError *zonarosa_uuid_ciphertext_check_valid_contents(ZonaRosaBorrowedBuffer buffer);

ZonaRosaFfiError *zonarosa_validating_mac_destroy(ZonaRosaMutPointerValidatingMac p);

ZonaRosaFfiError *zonarosa_validating_mac_finalize(int32_t *out, ZonaRosaMutPointerValidatingMac mac);

ZonaRosaFfiError *zonarosa_validating_mac_initialize(ZonaRosaMutPointerValidatingMac *out, ZonaRosaBorrowedBuffer key, uint32_t chunk_size, ZonaRosaBorrowedBuffer digests);

ZonaRosaFfiError *zonarosa_validating_mac_update(int32_t *out, ZonaRosaMutPointerValidatingMac mac, ZonaRosaBorrowedBuffer bytes, uint32_t offset, uint32_t length);

ZonaRosaFfiError *zonarosa_webp_sanitizer_sanitize(ZonaRosaConstPointerFfiSyncInputStreamStruct input);

#endif  /* ZONAROSA_FFI_H_ */
